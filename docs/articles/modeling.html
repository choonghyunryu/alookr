<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Classification Modeling • alookr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Classification Modeling">
<meta property="og:description" content="alookr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">alookr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/cleansing.html">Cleansing the dataset</a>
</li>
<li>
  <a href="../articles/split.html">Splitting the dataset</a>
</li>
<li>
  <a href="../articles/modeling.html">Classification Modeling</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../reference/index.html">Function reference</a>
</li>
<li>
  <a href="https://github.com/choonghyunryu/alookr/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="modeling_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Classification Modeling</h1>
                        <h4 class="author">Choonghyun Ryu</h4>
            
            <h4 class="date">2020-08-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/choonghyunryu/alookr/blob/master/vignettes/modeling.Rmd"><code>vignettes/modeling.Rmd</code></a></small>
      <div class="hidden name"><code>modeling.Rmd</code></div>

    </div>

    
    
<div id="preface" class="section level2">
<h2 class="hasAnchor">
<a href="#preface" class="anchor"></a>Preface</h2>
<p>Once the data set is ready for model development, the model is fitted, predicted and evaluated in the following ways:</p>
<ul>
<li>Cleansing the dataset</li>
<li>Split the data into a train set and a test set</li>
<li>
<strong>Modeling and Evaluate, Predict</strong>
<ul>
<li>
<strong>Modeling</strong>
<ul>
<li><strong>Binary classification modeling</strong></li>
</ul>
</li>
<li>
<strong>Evaluate the model</strong>
<ul>
<li><strong>Predict test set using fitted model</strong></li>
<li><strong>Calculate the performance metric</strong></li>
<li><strong>Plot the ROC curve</strong></li>
<li>
<strong>Tunning the cut-off</strong><br>
</li>
</ul>
</li>
<li>
<strong>Predict</strong>
<ul>
<li><strong>Predict</strong></li>
<li><strong>Predict with cut-off</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The alookr package makes these steps fast and easy:</p>
</div>
<div id="data-wisconsin-breast-cancer-data" class="section level2">
<h2 class="hasAnchor">
<a href="#data-wisconsin-breast-cancer-data" class="anchor"></a>Data: Wisconsin Breast Cancer Data</h2>
<p><code>BreastCancer</code> of <code>mlbench package</code> is a breast cancer data. The objective is to identify each of a number of benign or malignant classes.</p>
<p>A data frame with 699 observations on 11 variables, one being a character variable, 9 being ordered or nominal, and 1 target class.:</p>
<ul>
<li>
<code>Id</code> : character. Sample code number</li>
<li>
<code>Cl.thickness</code> : ordered factor. Clump Thickness</li>
<li>
<code>Cell.size</code> : ordered factor. Uniformity of Cell Size</li>
<li>
<code>Cell.shape</code> : ordered factor. Uniformity of Cell Shape</li>
<li>
<code>Marg.adhesion</code> : ordered factor. Marginal Adhesion</li>
<li>
<code>Epith.c.size</code> : ordered factor. Single Epithelial Cell Size</li>
<li>
<code>Bare.nuclei</code> : factor. Bare Nuclei</li>
<li>
<code>Bl.cromatin</code> : factor. Bland Chromatin</li>
<li>
<code>Normal.nucleoli</code> : factor. Normal Nucleoli</li>
<li>
<code>Mitoses</code> : factor. Mitoses</li>
<li>
<code>Class</code> : factor. Class. level is <code>benign</code> and <code>malignant</code>.</li>
</ul>
<div class="sourceCode" id="cb1"><html><body><pre class="r">library(mlbench)
data(BreastCancer)

# class of each variables
sapply(BreastCancer, function(x) class(x)[1])
             Id    Cl.thickness       Cell.size      Cell.shape   Marg.adhesion 
    "character"       "ordered"       "ordered"       "ordered"       "ordered" 
   Epith.c.size     Bare.nuclei     Bl.cromatin Normal.nucleoli         Mitoses 
      "ordered"        "factor"        "factor"        "factor"        "factor" 
          Class 
       "factor" </pre></body></html></div>
</div>
<div id="preperation-the-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preperation-the-data" class="anchor"></a>Preperation the data</h2>
<p>Perform data preprocessing as follows.:</p>
<ul>
<li>Find and imputate variables that contain missing values.</li>
<li>Split the data into a train set and a test set.</li>
<li>To solve the imbalanced class, perform sampling in the train set of raw data.</li>
<li>Cleansing the dataset for classification modeling.</li>
</ul>
<div id="fix-the-missing-value-with-dlookrimputate_na" class="section level3">
<h3 class="hasAnchor">
<a href="#fix-the-missing-value-with-dlookrimputate_na" class="anchor"></a>Fix the missing value with <code>dlookr::imputate_na()</code>
</h3>
<p>find the variables that include missing value. and imputate the missing value using imputate_na() in dlookr package.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r">library(dlookr)
library(dplyr)

# variable that have a missing value
diagnose(BreastCancer) %&gt;%
  filter(missing_count &gt; 0)
# A tibble: 1 x 6
  variables   types  missing_count missing_percent unique_count unique_rate
  &lt;chr&gt;       &lt;chr&gt;          &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;
1 Bare.nuclei factor            16            2.29           11      0.0157

# imputation of missing value
breastCancer &lt;- BreastCancer %&gt;%
  mutate(Bare.nuclei = imputate_na(BreastCancer, Bare.nuclei, Class,
                         method = "mice", no_attrs = TRUE, print_flag = FALSE))</pre></body></html></div>
</div>
</div>
<div id="split-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#split-data-set" class="anchor"></a>Split data set</h2>
<div id="splits-the-dataset-into-a-train-set-and-a-test-set-with-split_by" class="section level3">
<h3 class="hasAnchor">
<a href="#splits-the-dataset-into-a-train-set-and-a-test-set-with-split_by" class="anchor"></a>Splits the dataset into a train set and a test set with <code>split_by()</code>
</h3>
<p><code><a href="../reference/split_by.data.frame.html">split_by()</a></code> in the alookr package splits the dataset into a train set and a test set.</p>
<p>The ratio argument of the <code><a href="../reference/split_by.data.frame.html">split_by()</a></code> function specifies the ratio of the train set.</p>
<p><code><a href="../reference/split_by.data.frame.html">split_by()</a></code> creates a class object named split_df.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r">library(alookr)

# split the data into a train set and a test set by default arguments
sb &lt;- breastCancer %&gt;%
  split_by(target = Class)

# show the class name
class(sb)
[1] "split_df"   "grouped_df" "tbl_df"     "tbl"        "data.frame"

# split the data into a train set and a test set by ratio = 0.6
tmp &lt;- breastCancer %&gt;%
  split_by(Class, ratio = 0.6)</pre></body></html></div>
<p>The <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function displays the following useful information about the split_df object:</p>
<ul>
<li>random seed : The random seed is the random seed used internally to separate the data</li>
<li>split data : Information of splited data
<ul>
<li>train set count : number of train set</li>
<li>test set count : number of test set</li>
</ul>
</li>
<li>target variable : Target variable name
<ul>
<li>minority class : name and ratio(In parentheses) of minority class</li>
<li>majority class : name and ratio(In parentheses) of majority class</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb4"><html><body><pre class="r"># summary() display the some information
summary(sb)
** Split train/test set information **
 + random seed        :  70050 
 + split data            
    - train set count :  489 
    - test set count  :  210 
 + target variable    :  Class 
    - minority class  :  malignant (0.344778)
    - majority class  :  benign (0.655222)

# summary() display the some information
summary(tmp)
** Split train/test set information **
 + random seed        :  96070 
 + split data            
    - train set count :  419 
    - test set count  :  280 
 + target variable    :  Class 
    - minority class  :  malignant (0.344778)
    - majority class  :  benign (0.655222)</pre></body></html></div>
</div>
<div id="check-missing-levels-in-the-train-set" class="section level3">
<h3 class="hasAnchor">
<a href="#check-missing-levels-in-the-train-set" class="anchor"></a>Check missing levels in the train set</h3>
<p>In the case of categorical variables, when a train set and a test set are separated, a specific level may be missing from the train set.</p>
<p>In this case, there is no problem when fitting the model, but an error occurs when predicting with the model you created. Therefore, preprocessing is performed to avoid missing data preprocessing.</p>
<p>In the following example, fortunately, there is no categorical variable that contains the missing levels in the train set.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># list of categorical variables in the train set that contain missing levels</span>
<span class="no">nolevel_in_train</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/compare_target_category.html">compare_target_category</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">train</span>)) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">variable</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>() <span class="kw">%&gt;%</span>
  <span class="no">pull</span>

<span class="no">nolevel_in_train</span>
<span class="fu"><a href="https://rdrr.io/r/base/character.html">character</a></span>(<span class="fl">0</span>)

<span class="co"># if any of the categorical variables in the train set contain a missing level, </span>
<span class="co"># split them again.</span>
<span class="kw">while</span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">nolevel_in_train</span>) <span class="kw">&gt;</span> <span class="fl">0</span>) {
  <span class="no">sb</span> <span class="kw">&lt;-</span> <span class="no">breastCancer</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/split_by.data.frame.html">split_by</a></span>(<span class="no">Class</span>)

  <span class="no">nolevel_in_train</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="../reference/compare_target_category.html">compare_target_category</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">train</span>)) <span class="kw">%&gt;%</span>
    <span class="fu">select</span>(<span class="no">variable</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>() <span class="kw">%&gt;%</span>
    <span class="no">pull</span>
}</pre></body></html></div>
</div>
</div>
<div id="handling-the-imbalanced-classes-data-with-sampling_target" class="section level2">
<h2 class="hasAnchor">
<a href="#handling-the-imbalanced-classes-data-with-sampling_target" class="anchor"></a>Handling the imbalanced classes data with <code>sampling_target()</code>
</h2>
<div id="issue-of-imbalanced-classes-data" class="section level3">
<h3 class="hasAnchor">
<a href="#issue-of-imbalanced-classes-data" class="anchor"></a>Issue of imbalanced classes data</h3>
<p>Imbalanced classes(levels) data means that the number of one level of the frequency of the target variable is relatively small. In general, the proportion of positive classes is relatively small. For example, in the model of predicting spam, the class of interest spam is less than non-spam.</p>
<p>Imbalanced classes data is a common problem in machine learning classification.</p>
<p><code><a href="https://rdrr.io/r/base/table.html">table()</a></code> and <code><a href="https://rdrr.io/r/base/proportions.html">prop.table()</a></code> are traditionally useful functions for diagnosing imbalanced classes data. However, alookr’s <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> is simpler and provides more information.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"># train set frequency table - imbalanced classes data
table(sb$Class)

   benign malignant 
      458       241 

# train set relative frequency table - imbalanced classes data
prop.table(table(sb$Class))

   benign malignant 
0.6552217 0.3447783 

# using summary function - imbalanced classes data
summary(sb)
** Split train/test set information **
 + random seed        :  70050 
 + split data            
    - train set count :  489 
    - test set count  :  210 
 + target variable    :  Class 
    - minority class  :  malignant (0.344778)
    - majority class  :  benign (0.655222)</pre></body></html></div>
</div>
<div id="handling-the-imbalanced-classes-data" class="section level3">
<h3 class="hasAnchor">
<a href="#handling-the-imbalanced-classes-data" class="anchor"></a>Handling the imbalanced classes data</h3>
<p>Most machine learning algorithms work best when the number of samples in each class are about equal. And most algorithms are designed to maximize accuracy and reduce error. So, we requre handling an imbalanced class problem.</p>
<p>sampling_target() performs sampling to solve an imbalanced classes data problem.</p>
</div>
<div id="resampling---oversample-minority-class" class="section level3">
<h3 class="hasAnchor">
<a href="#resampling---oversample-minority-class" class="anchor"></a>Resampling - oversample minority class</h3>
<p>Oversampling can be defined as adding more copies of the minority class.</p>
<p>Oversampling is performed by specifying “ubOver” in the method argument of the <code><a href="../reference/sampling_target.html">sampling_target()</a></code> function.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"># to balanced by over sampling
train_over &lt;- sb %&gt;%
  sampling_target(method = "ubOver")

# frequency table 
table(train_over$Class)

   benign malignant 
      326       326 </pre></body></html></div>
</div>
<div id="resampling---undersample-majority-class" class="section level3">
<h3 class="hasAnchor">
<a href="#resampling---undersample-majority-class" class="anchor"></a>Resampling - undersample majority class</h3>
<p>Undersampling can be defined as removing some observations of the majority class.</p>
<p>Undersampling is performed by specifying “ubUnder” in the method argument of the <code><a href="../reference/sampling_target.html">sampling_target()</a></code> function.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"># to balanced by under sampling
train_under &lt;- sb %&gt;%
  sampling_target(method = "ubUnder")

# frequency table 
table(train_under$Class)

   benign malignant 
      163       163 </pre></body></html></div>
</div>
<div id="generate-synthetic-samples---smote" class="section level3">
<h3 class="hasAnchor">
<a href="#generate-synthetic-samples---smote" class="anchor"></a>Generate synthetic samples - SMOTE</h3>
<p>SMOTE(Synthetic Minority Oversampling Technique) uses a nearest neighbors algorithm to generate new and synthetic data.</p>
<p>SMOTE is performed by specifying “ubSMOTE” in the method argument of the <code><a href="../reference/sampling_target.html">sampling_target()</a></code> function.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"># to balanced by SMOTE
train_smote &lt;- sb %&gt;%
  sampling_target(seed = 1234L, method = "ubSMOTE")

# frequency table 
table(train_smote$Class)

   benign malignant 
      652       489 </pre></body></html></div>
</div>
</div>
<div id="cleansing-the-dataset-for-classification-modeling-with-cleanse" class="section level2">
<h2 class="hasAnchor">
<a href="#cleansing-the-dataset-for-classification-modeling-with-cleanse" class="anchor"></a>Cleansing the dataset for classification modeling with <code>cleanse()</code>
</h2>
<p>The <code><a href="../reference/cleanse.data.frame.html">cleanse()</a></code> cleanse the dataset for classification modeling.</p>
<p>This function is useful when fit the classification model. This function does the following.:</p>
<ul>
<li>Remove the variable with only one value.</li>
<li>And remove variables that have a unique number of values relative to the number of observations for a character or categorical variable.
<ul>
<li>In this case, it is a variable that corresponds to an identifier or an identifier.</li>
</ul>
</li>
<li>And converts the character to factor.</li>
</ul>
<p>In this example, The <code><a href="../reference/cleanse.data.frame.html">cleanse()</a></code> function removed a variable ID with a high unique rate.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"># clean the training set
train &lt;- train_smote %&gt;%
  cleanse
── Checking unique value ─────────────────────────── unique value is one ──
No variables that unique value is one.

── Checking unique rate ─────────────────────────────── high unique rate ──
remove variables with high unique rate
● Id = 414(0.362839614373357)

── Checking character variables ─────────────────────── categorical data ──
No character variables.</pre></body></html></div>
</div>
<div id="extract-test-set-for-evaluation-of-the-model-with-extract_set" class="section level2">
<h2 class="hasAnchor">
<a href="#extract-test-set-for-evaluation-of-the-model-with-extract_set" class="anchor"></a>Extract test set for evaluation of the model with <code>extract_set()</code>
</h2>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># extract test set</span>
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/extract_set.html">extract_set</a></span>(<span class="kw">set</span> <span class="kw">=</span> <span class="st">"test"</span>)</pre></body></html></div>
</div>
<div id="binary-classification-modeling-with-run_models" class="section level2">
<h2 class="hasAnchor">
<a href="#binary-classification-modeling-with-run_models" class="anchor"></a>Binary classification modeling with <code>run_models()</code>
</h2>
<p><code><a href="../reference/run_models.html">run_models()</a></code> performs some representative binary classification modeling using <code>split_df</code> object created by <code><a href="../reference/split_by.data.frame.html">split_by()</a></code>.</p>
<p><code><a href="../reference/run_models.html">run_models()</a></code> executes the process in parallel when fitting the model. However, it is not supported in MS-Windows operating system and RStudio environment.</p>
<p>Currently supported algorithms are as follows.:</p>
<ul>
<li>logistic : logistic regression using <code>stats</code> package</li>
<li>rpart : Recursive Partitioning Trees using <code>rpart</code> package</li>
<li>ctree : Conditional Inference Trees using <code>party</code> package</li>
<li>randomForest :Classification with Random Forest using <code>randomForest</code> package</li>
<li>ranger : A Fast Implementation of Random Forests using <code>ranger</code> package</li>
</ul>
<p><code><a href="../reference/run_models.html">run_models()</a></code> returns a <code>model_df</code> class object.</p>
<p>The <code>model_df</code> class object contains the following variables.:</p>
<ul>
<li>step : character. The current stage in the classification modeling process.
<ul>
<li>For objects created with <code><a href="../reference/run_models.html">run_models()</a></code>, the value of the variable is “1.Fitted”.</li>
</ul>
</li>
<li>model_id : model identifiers</li>
<li>target : name of target variable</li>
<li>positive : positive class in target variable</li>
<li>fitted_model : list. Fitted model object by model_id’s algorithms</li>
</ul>
<div class="sourceCode" id="cb12"><html><body><pre class="r">result &lt;- train %&gt;% 
  run_models(target = "Class", positive = "malignant")
result
# A tibble: 5 x 5
  step     model_id     target positive  fitted_model
  &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;     &lt;list&gt;      
1 1.Fitted logistic     Class  malignant &lt;glm&gt;       
2 1.Fitted rpart        Class  malignant &lt;rpart&gt;     
3 1.Fitted ctree        Class  malignant &lt;BinaryTr&gt;  
4 1.Fitted randomForest Class  malignant &lt;rndmFrs.&gt;  
5 1.Fitted ranger       Class  malignant &lt;ranger&gt;    </pre></body></html></div>
</div>
<div id="evaluate-the-model" class="section level2">
<h2 class="hasAnchor">
<a href="#evaluate-the-model" class="anchor"></a>Evaluate the model</h2>
<p>Evaluate the predictive performance of fitted models.</p>
<div id="predict-test-set-using-fitted-model-with-run_predict" class="section level3">
<h3 class="hasAnchor">
<a href="#predict-test-set-using-fitted-model-with-run_predict" class="anchor"></a>Predict test set using fitted model with <code>run_predict()</code>
</h3>
<p><code><a href="../reference/run_predict.html">run_predict()</a></code> predict the test set using <code>model_df</code> class fitted by <code><a href="../reference/run_models.html">run_models()</a></code>.</p>
<p><code><a href="../reference/run_predict.html">run_predict ()</a></code> is executed in parallel when predicting by model. However, it is not supported in MS-Windows operating system and RStudio environment.</p>
<p>The <code>model_df</code> class object contains the following variables.:</p>
<ul>
<li>step : character. The current stage in the classification modeling process.
<ul>
<li>For objects created with <code><a href="../reference/run_predict.html">run_predict()</a></code>, the value of the variable is “2.Predicted”.</li>
</ul>
</li>
<li>model_id : character. Type of fit model.</li>
<li>target : character. Name of target variable.</li>
<li>positive : character. Level of positive class of binary classification.</li>
<li>fitted_model : list. Fitted model object by model_id’s algorithms.</li>
<li>predicted : result of predcit by each models</li>
</ul>
<div class="sourceCode" id="cb13"><html><body><pre class="r">pred &lt;- result %&gt;%
  run_predict(test)
pred
# A tibble: 5 x 6
  step        model_id     target positive  fitted_model predicted  
  &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;     &lt;list&gt;       &lt;list&gt;     
1 2.Predicted logistic     Class  malignant &lt;glm&gt;        &lt;fct [210]&gt;
2 2.Predicted rpart        Class  malignant &lt;rpart&gt;      &lt;fct [210]&gt;
3 2.Predicted ctree        Class  malignant &lt;BinaryTr&gt;   &lt;fct [210]&gt;
4 2.Predicted randomForest Class  malignant &lt;rndmFrs.&gt;   &lt;fct [210]&gt;
5 2.Predicted ranger       Class  malignant &lt;ranger&gt;     &lt;fct [210]&gt;</pre></body></html></div>
</div>
<div id="calculate-the-performance-metric-with-run_performance" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-the-performance-metric-with-run_performance" class="anchor"></a>Calculate the performance metric with <code>run_performance()</code>
</h3>
<p><code><a href="../reference/run_performance.html">run_performance()</a></code> calculate the performance metric of <code>model_df</code> class predicted by <code><a href="../reference/run_predict.html">run_predict()</a></code>.</p>
<p><code><a href="../reference/run_performance.html">run_performance ()</a></code> is performed in parallel when calculating the performance evaluation metrics However, it is not supported in MS-Windows operating system and RStudio environment.</p>
<p>The <code>model_df</code> class object contains the following variables.:</p>
<ul>
<li>step : character. The current stage in the classification modeling process.
<ul>
<li>For objects created with <code><a href="../reference/run_performance.html">run_performance()</a></code>, the value of the variable is “3.Performanced”.</li>
</ul>
</li>
<li>model_id : character. Type of fit model.</li>
<li>target : character. Name of target variable.</li>
<li>positive : character. Level of positive class of binary classification.</li>
<li>fitted_model : list. Fitted model object by model_id’s algorithms</li>
<li>predicted : list. Predicted value by individual model. Each value has a predict_class class object.</li>
<li>performance : list. Calculate metrics by individual model. Each value has a numeric vector.</li>
</ul>
<div class="sourceCode" id="cb14"><html><body><pre class="r"># Calculate performace metrics.
perf &lt;- run_performance(pred)
perf
# A tibble: 5 x 7
  step          model_id     target positive fitted_model predicted  performance
  &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;list&gt;       &lt;list&gt;     &lt;list&gt;     
1 3.Performanc… logistic     Class  maligna… &lt;glm&gt;        &lt;fct [210… &lt;dbl [15]&gt; 
2 3.Performanc… rpart        Class  maligna… &lt;rpart&gt;      &lt;fct [210… &lt;dbl [15]&gt; 
3 3.Performanc… ctree        Class  maligna… &lt;BinaryTr&gt;   &lt;fct [210… &lt;dbl [15]&gt; 
4 3.Performanc… randomForest Class  maligna… &lt;rndmFrs.&gt;   &lt;fct [210… &lt;dbl [15]&gt; 
5 3.Performanc… ranger       Class  maligna… &lt;ranger&gt;     &lt;fct [210… &lt;dbl [15]&gt; </pre></body></html></div>
<p>The performance variable contains a list object, which contains 15 performance metrics:</p>
<ul>
<li>ZeroOneLoss : Normalized Zero-One Loss(Classification Error Loss).</li>
<li>Accuracy : Accuracy.</li>
<li>Precision : Precision.</li>
<li>Recall : Recall.</li>
<li>Sensitivity : Sensitivity.</li>
<li>Specificity : Specificity.</li>
<li>F1_Score : F1 Score.</li>
<li>Fbeta_Score : F-Beta Score.</li>
<li>LogLoss : Log loss / Cross-Entropy Loss.</li>
<li>AUC : Area Under the Receiver Operating Characteristic Curve (ROC AUC).</li>
<li>Gini : Gini Coefficient.</li>
<li>PRAUC : Area Under the Precision-Recall Curve (PR AUC).</li>
<li>LiftAUC : Area Under the Lift Chart.</li>
<li>GainAUC : Area Under the Gain Chart.</li>
<li>KS_Stat : Kolmogorov-Smirnov Statistic.</li>
</ul>
<div class="sourceCode" id="cb15"><html><body><pre class="r"># Performance by analytics models
performance &lt;- perf$performance
names(performance) &lt;- perf$model_id
performance
$logistic
ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity 
 0.07142857  0.92857143  0.87951807  0.93589744  0.93589744  0.92424242 
   F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC 
 0.90683230  0.90683230  2.27569631  0.94036519  0.91083916  0.08785815 
    LiftAUC     GainAUC     KS_Stat 
 1.07604217  0.77680098 86.53846154 

$rpart
ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity 
 0.06666667  0.93333333  0.87209302  0.96153846  0.96153846  0.91666667 
   F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC 
 0.91463415  0.91463415  0.23371764  0.95391414  0.92812743  0.80890685 
    LiftAUC     GainAUC     KS_Stat 
 1.87314793  0.78531746 90.32634033 

$ctree
ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity 
 0.05714286  0.94285714  0.89285714  0.96153846  0.96153846  0.93181818 
   F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC 
 0.92592593  0.92592593  0.23438675  0.96207265  0.92501943  0.89859855 
    LiftAUC     GainAUC     KS_Stat 
 1.96427330  0.79044567 89.62703963 

$randomForest
ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity 
 0.02857143  0.97142857  0.93902439  0.98717949  0.98717949  0.96212121 
   F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC 
 0.96250000  0.96250000  0.13450581  0.98713092  0.97455322  0.69273918 
    LiftAUC     GainAUC     KS_Stat 
 1.73018476  0.80619658 95.68764569 

$ranger
ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity 
 0.02857143  0.97142857  0.93902439  0.98717949  0.98717949  0.96212121 
   F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC 
 0.96250000  0.96250000  0.12560570  0.98805361  0.97610723  0.88769424 
    LiftAUC     GainAUC     KS_Stat 
 1.92129055  0.80677656 95.68764569 </pre></body></html></div>
<p>If you change the list object to tidy format, you’ll see the following at a glance:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"># Convert to matrix for compare performace.
sapply(performance, "c")
               logistic       rpart       ctree randomForest      ranger
ZeroOneLoss  0.07142857  0.06666667  0.05714286   0.02857143  0.02857143
Accuracy     0.92857143  0.93333333  0.94285714   0.97142857  0.97142857
Precision    0.87951807  0.87209302  0.89285714   0.93902439  0.93902439
Recall       0.93589744  0.96153846  0.96153846   0.98717949  0.98717949
Sensitivity  0.93589744  0.96153846  0.96153846   0.98717949  0.98717949
Specificity  0.92424242  0.91666667  0.93181818   0.96212121  0.96212121
F1_Score     0.90683230  0.91463415  0.92592593   0.96250000  0.96250000
Fbeta_Score  0.90683230  0.91463415  0.92592593   0.96250000  0.96250000
LogLoss      2.27569631  0.23371764  0.23438675   0.13450581  0.12560570
AUC          0.94036519  0.95391414  0.96207265   0.98713092  0.98805361
Gini         0.91083916  0.92812743  0.92501943   0.97455322  0.97610723
PRAUC        0.08785815  0.80890685  0.89859855   0.69273918  0.88769424
LiftAUC      1.07604217  1.87314793  1.96427330   1.73018476  1.92129055
GainAUC      0.77680098  0.78531746  0.79044567   0.80619658  0.80677656
KS_Stat     86.53846154 90.32634033 89.62703963  95.68764569 95.68764569</pre></body></html></div>
<p><code><a href="../reference/compare_performance.html">compare_performance()</a></code> return a list object(results of compared model performance). and list has the following components:</p>
<ul>
<li>recommend_model : character. The name of the model that is recommended as the best among the various models.</li>
<li>top_count : numeric. The number of best performing performance metrics by model.</li>
<li>mean_rank : numeric. Average of ranking individual performance metrics by model.</li>
<li>top_metric : list. The name of the performance metric with the best performance on individual performance metrics by model.</li>
</ul>
<p>In this example, <code><a href="../reference/compare_performance.html">compare_performance()</a></code> recommend the <strong>“ranger”</strong> model.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"># Compaire the Performance metrics of each model
comp_perf &lt;- compare_performance(pred)
comp_perf
$recommend_model
[1] "ranger"

$top_metric_count
    logistic        rpart        ctree randomForest       ranger 
           0            0            2            7           11 

$mean_rank
    logistic        rpart        ctree randomForest       ranger 
    4.846154     3.730769     2.961538     2.038462     1.423077 

$top_metric
$top_metric$logistic
NULL

$top_metric$rpart
NULL

$top_metric$ctree
[1] "PRAUC"   "LiftAUC"

$top_metric$randomForest
[1] "ZeroOneLoss" "Accuracy"    "Precision"   "Recall"      "Specificity"
[6] "F1_Score"    "KS_Stat"    

$top_metric$ranger
 [1] "ZeroOneLoss" "Accuracy"    "Precision"   "Recall"      "Specificity"
 [6] "F1_Score"    "LogLoss"     "AUC"         "Gini"        "GainAUC"    
[11] "KS_Stat"    </pre></body></html></div>
</div>
<div id="plot-the-roc-curve-with-plot_performance" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-the-roc-curve-with-plot_performance" class="anchor"></a>Plot the ROC curve with <code>plot_performance()</code>
</h3>
<p><code><a href="../reference/compare_performance.html">compare_performance()</a></code> plot ROC curve.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># Plot ROC curve</span>
<span class="fu"><a href="../reference/plot_performance.html">plot_performance</a></span>(<span class="no">pred</span>)</pre></body></html></div>
<p><img src="modeling_files/figure-html/ROC-1.png" width="672"></p>
</div>
<div id="tunning-the-cut-off" class="section level3">
<h3 class="hasAnchor">
<a href="#tunning-the-cut-off" class="anchor"></a>Tunning the cut-off</h3>
<p>In general, if the prediction probability is greater than 0.5 in the binary classification model, it is predicted as <code>positive class</code>. In other words, 0.5 is used for the cut-off value. This applies to most model algorithms. However, in some cases, the performance can be tuned by changing the cut-off value.</p>
<p><code><a href="../reference/plot_cutoff.html">plot_cutoff ()</a></code> visualizes a plot to select the cut-off value, and returns the cut-off value.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">pred_best</span> <span class="kw">&lt;-</span> <span class="no">pred</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="no">model_id</span> <span class="kw">==</span> <span class="no">comp_perf</span>$<span class="no">recommend_model</span>) <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">predicted</span>) <span class="kw">%&gt;%</span>
  <span class="no">pull</span> <span class="kw">%&gt;%</span>
  <span class="no">.</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="st">"pred_prob"</span>)

<span class="no">cutoff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/plot_cutoff.html">plot_cutoff</a></span>(<span class="no">pred_best</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"mcc"</span>)</pre></body></html></div>
<p><img src="modeling_files/figure-html/cutoff-1.png" width="672"></p>
<div class="sourceCode" id="cb20"><html><body><pre class="r">cutoff
[1] 0.62

cutoff2 &lt;- plot_cutoff(pred_best, test$Class, "malignant", type = "density")</pre></body></html></div>
<p><img src="modeling_files/figure-html/cutoff-2.png" width="672"></p>
<div class="sourceCode" id="cb21"><html><body><pre class="r">cutoff2
[1] 0.9765

cutoff3 &lt;- plot_cutoff(pred_best, test$Class, "malignant", type = "prob")</pre></body></html></div>
<p><img src="modeling_files/figure-html/cutoff-3.png" width="672"></p>
<div class="sourceCode" id="cb22"><html><body><pre class="r">cutoff3
[1] 0.62</pre></body></html></div>
</div>
<div id="performance-comparison-between-prediction-and-tuned-cut-off-with-performance_metric" class="section level3">
<h3 class="hasAnchor">
<a href="#performance-comparison-between-prediction-and-tuned-cut-off-with-performance_metric" class="anchor"></a>Performance comparison between prediction and tuned cut-off with <code>performance_metric()</code>
</h3>
<p>Compare the performance of the original prediction with that of the tuned cut-off. Compare the cut-off with the non-cut model for the model with the best performance <code>comp_perf$recommend_model</code>.</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r">comp_perf$recommend_model
[1] "ranger"

# extract predicted probability
idx &lt;- which(pred$model_id == comp_perf$recommend_model)
pred_prob &lt;- attr(pred$predicted[[idx]], "pred_prob")

# or, extract predicted probability using dplyr
pred_prob &lt;- pred %&gt;% 
  filter(model_id == comp_perf$recommend_model) %&gt;% 
  select(predicted) %&gt;% 
  pull %&gt;% 
  "[["(1) %&gt;% 
  attr("pred_prob")

# predicted probability
pred_prob  
  [1] 0.9625912698 0.3832142857 0.0000000000 0.0000000000 0.6559928571
  [6] 0.0023571429 0.9909293651 0.9677134921 0.0000000000 0.7702634921
 [11] 0.0000000000 0.0000000000 0.9996000000 0.7835341270 0.0000000000
 [16] 0.6255047619 0.9813888889 0.7988746032 0.9609301587 0.0000000000
 [21] 0.8554539683 0.9906158730 0.9323309524 0.0124928571 0.2229595238
 [26] 0.2062563492 0.9757166667 0.9866230159 0.0000000000 0.0000000000
 [31] 0.0000000000 0.9918444444 0.9489206349 0.9796571429 0.9704634921
 [36] 0.9817761905 0.0000000000 0.9598277778 0.2186293651 0.9268436508
 [41] 0.0000000000 0.0000000000 0.9974285714 0.0000000000 0.5494380952
 [46] 0.9997500000 0.9363706349 0.0000000000 0.0000000000 0.9964920635
 [51] 0.6225682540 0.0000000000 0.9990000000 0.0000000000 0.9992000000
 [56] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000
 [61] 0.0000000000 1.0000000000 0.0000000000 1.0000000000 0.9988000000
 [66] 0.0000000000 0.0000000000 0.0155746032 1.0000000000 0.0000000000
 [71] 0.9338492063 0.1465261905 0.2608380952 0.0000000000 0.2651531746
 [76] 0.0000000000 0.9036865079 0.9275246032 0.0000000000 0.0000000000
 [81] 0.9846873016 0.9925833333 0.9964857143 0.9601738095 1.0000000000
 [86] 0.6841587302 0.0000000000 0.8684642857 0.9777753968 0.9947666667
 [91] 0.9234444444 0.9735325397 0.9951238095 0.0000000000 0.9982666667
 [96] 0.2801976190 0.0000000000 0.9593682540 0.9997500000 0.0000000000
[101] 0.0000000000 0.9800039683 0.9550015873 0.0004000000 0.9622134921
[106] 0.9943611111 0.9828896825 0.9098087302 0.0000000000 0.9960873016
[111] 0.0000000000 0.0924809524 0.0075134921 0.0000000000 0.8984031746
[116] 0.0000000000 0.9990476190 0.0000000000 0.3909849206 0.0000000000
[121] 0.1154809524 0.0144000000 0.0000000000 1.0000000000 0.0000000000
[126] 0.0000000000 0.0002222222 0.0036746032 0.8932690476 0.0000000000
[131] 0.0345032468 0.8875031746 0.0000000000 0.0000000000 0.8901095238
[136] 0.0000000000 0.1233857143 0.0000000000 0.0000000000 0.0000000000
[141] 0.0000000000 0.0000000000 0.9642984127 0.9972285714 0.0000000000
[146] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000
[151] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000
[156] 0.0000000000 0.0000000000 0.9795341270 0.0000000000 0.9992000000
[161] 0.2563103175 0.0000000000 0.9906952381 0.0000000000 0.0000000000
[166] 1.0000000000 0.0000000000 0.9646476190 0.0000000000 0.0000000000
[171] 0.0000000000 0.0000000000 0.0000000000 0.4048095238 0.0000000000
[176] 0.0000000000 0.9951238095 0.9977420635 0.0000000000 0.0000000000
[181] 0.0002857143 0.0000000000 0.9347023810 0.9463571429 0.9931857143
[186] 1.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000
[191] 0.1809944444 0.0000000000 0.0000000000 0.0000000000 0.0116682540
[196] 0.9980000000 0.0220888889 0.0000000000 0.0000000000 0.0000000000
[201] 0.0000000000 0.0000000000 0.0000000000 0.0219000000 0.0088349206
[206] 0.0000000000 0.9989166667 0.0000000000 0.0000000000 0.9252198413

# compaire Accuracy
performance_metric(pred_prob, test$Class, "malignant", "Accuracy")
[1] 0.9714286
performance_metric(pred_prob, test$Class, "malignant", "Accuracy",
                   cutoff = cutoff)
[1] 0.9761905

# compaire Confusion Matrix
performance_metric(pred_prob, test$Class, "malignant", "ConfusionMatrix")
           actual
predict     benign malignant
  benign       127         1
  malignant      5        77
performance_metric(pred_prob, test$Class, "malignant", "ConfusionMatrix", 
                   cutoff = cutoff)
           actual
predict     benign malignant
  benign       128         1
  malignant      4        77

# compaire F1 Score
performance_metric(pred_prob, test$Class, "malignant", "F1_Score")
[1] 0.9625
performance_metric(pred_prob, test$Class,  "malignant", "F1_Score", 
                   cutoff = cutoff)
[1] 0.9685535
performance_metric(pred_prob, test$Class,  "malignant", "F1_Score", 
                   cutoff = cutoff2)
[1] 0.7107438</pre></body></html></div>
<p>If the performance of the tuned cut-off is good, use it as a cut-off to predict positives.</p>
</div>
</div>
<div id="predict" class="section level2">
<h2 class="hasAnchor">
<a href="#predict" class="anchor"></a>Predict</h2>
<p>If you have selected a good model from several models, then perform the prediction with that model.</p>
<div id="create-data-set-for-predict" class="section level3">
<h3 class="hasAnchor">
<a href="#create-data-set-for-predict" class="anchor"></a>Create data set for predict</h3>
<p>Create sample data for predicting by extracting 100 samples from the data set used in the previous under sampling example.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r">data_pred &lt;- train_under %&gt;% 
  cleanse 
── Checking unique value ─────────────────────────── unique value is one ──
No variables that unique value is one.

── Checking unique rate ─────────────────────────────── high unique rate ──
remove variables with high unique rate
● Id = 318(0.975460122699387)

── Checking character variables ─────────────────────── categorical data ──
No character variables.

set.seed(1234L)
data_pred &lt;- data_pred %&gt;% 
  nrow %&gt;% 
  seq %&gt;% 
  sample(size = 50) %&gt;% 
  data_pred[., ]</pre></body></html></div>
</div>
<div id="predict-with-alookr-and-dplyr" class="section level3">
<h3 class="hasAnchor">
<a href="#predict-with-alookr-and-dplyr" class="anchor"></a>Predict with alookr and dplyr</h3>
<p>Do a predict using the <code>dplyr</code> package. The last <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> function eliminates unnecessary information.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r">pred_actual &lt;- pred %&gt;%
  filter(model_id == comp_perf$recommend_model) %&gt;% 
  run_predict(data_pred) %&gt;% 
  select(predicted) %&gt;% 
  pull %&gt;% 
  "[["(1) %&gt;% 
  factor()

pred_actual
 [1] malignant benign    malignant benign    malignant benign    benign   
 [8] malignant malignant benign    benign    benign    malignant malignant
[15] malignant benign    benign    malignant malignant benign    malignant
[22] malignant malignant benign    malignant malignant malignant malignant
[29] benign    malignant malignant malignant malignant malignant malignant
[36] malignant malignant malignant benign    malignant malignant benign   
[43] benign    malignant benign    benign    benign    benign    malignant
[50] benign   
Levels: benign malignant</pre></body></html></div>
<p>If you want to predict by cut-off, specify the <code>cutoff</code> argument in the <code><a href="../reference/run_predict.html">run_predict()</a></code> function as follows.:</p>
<p>In the example, there is no difference between the results of using cut-off and not.</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r">pred_actual2 &lt;- pred %&gt;%
  filter(model_id == comp_perf$recommend_model) %&gt;% 
  run_predict(data_pred, cutoff) %&gt;% 
  select(predicted) %&gt;% 
  pull %&gt;% 
  "[["(1) %&gt;% 
  factor()

pred_actual2
 [1] malignant benign    malignant benign    malignant benign    benign   
 [8] malignant malignant benign    benign    benign    malignant malignant
[15] malignant benign    benign    malignant malignant benign    malignant
[22] malignant malignant benign    malignant malignant malignant malignant
[29] benign    malignant malignant malignant malignant malignant malignant
[36] malignant malignant malignant benign    malignant malignant benign   
[43] benign    benign    benign    benign    benign    benign    malignant
[50] benign   
Levels: benign malignant

sum(pred_actual != pred_actual2)
[1] 1</pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Choonghyun Ryu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
