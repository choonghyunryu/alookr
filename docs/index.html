<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model Classifier for Binary Classification • alookr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Model Classifier for Binary Classification">
<meta property="og:description" content="A collection of tools that support data splitting, predictive modeling, and model evaluation. 
    A typical function is to split a dataset into a training dataset and a test dataset. 
    Then compare the data distribution of the two datasets.
    Another feature is to support the development of predictive models and to compare the performance of several predictive models, 
    helping to select the best model. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">alookr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/cleansing.html">Cleansing the dataset</a>
    </li>
    <li>
      <a href="articles/modeling.html">Classification Modeling</a>
    </li>
    <li>
      <a href="articles/split.html">Splitting the dataset</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/choonghyunryu/alookr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="alookr-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#alookr-" class="anchor"></a>alookr <img src="reference/figures/alookr.png" align="right" height="120" width="103.6">
</h1></div>

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>Binary classification modeling with <code>alookr</code>.</p>
<p>Features:</p>
<ul>
<li>Clean and split data sets to train and test.</li>
<li>Create several representative models.</li>
<li>Evaluate the performance of the model to select the best model.</li>
<li>Support the entire process of developing a binary classification model.</li>
</ul>
<p>The name <code>alookr</code> comes from <code>looking at the analytics process</code> in the data analysis process.</p>
</div>
<div id="install-alookr" class="section level2">
<h2 class="hasAnchor">
<a href="#install-alookr" class="anchor"></a>Install alookr</h2>
<p>The released version is available on CRAN. but not yet.</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"alookr"</span>)</pre></div>
<p>Or you can get the development version without vignettes from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"choonghyunryu/alookr"</span>)</pre></div>
<p>Or you can get the development version with vignettes from GitHub:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ISLR"</span>, <span class="st">"spelling"</span>, <span class="st">"mlbench"</span>))
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"choonghyunryu/alookr"</span>, <span class="kw">build_vignettes</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>alookr includes several vignette files, which we use throughout the documentation.</p>
<p>Provided vignettes is as follows.</p>
<ul>
<li>Cleansing the dataset</li>
<li>Split the data into a train set and a test set</li>
<li>Modeling and Evaluate, Predict</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb4"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/browseVignettes.html">browseVignettes</a></span>(<span class="kw">package</span> <span class="kw">=</span> <span class="st">"alookr"</span>)</pre></div>
</div>
<div id="cleansing-the-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#cleansing-the-dataset" class="anchor"></a>Cleansing the dataset</h2>
<div id="data-create-example-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#data-create-example-dataset" class="anchor"></a>Data: create example dataset</h3>
<p>To illustrate basic use of the alookr package, create the <code>data_exam</code> with sample function. The <code>data_exam</code> dataset include 5 variables.</p>
<p>variables are as follows.:</p>
<ul>
<li>
<code>id</code> : character</li>
<li>
<code>year</code>: character</li>
<li>
<code>count</code>: numeric</li>
<li>
<code>alpha</code> : character</li>
<li>
<code>flag</code> : character</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb5"><pre class="r"><span class="co"># create sample dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123L</span>)
<span class="no">id</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="fl">1</span>:<span class="fl">1000</span>, <span class="kw">function</span>(<span class="no">x</span>)
  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">letters</span>, <span class="fl">5</span>), <span class="no">x</span>), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">""</span>))

<span class="no">year</span> <span class="kw">&lt;-</span> <span class="st">"2018"</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123L</span>)
<span class="no">count</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fl">10</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123L</span>)
<span class="no">alpha</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">letters</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123L</span>)
<span class="no">flag</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Y"</span>, <span class="st">"N"</span>), <span class="kw">size</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">prob</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>), <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)

<span class="no">data_exam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">id</span>, <span class="no">year</span>, <span class="no">count</span>, <span class="no">alpha</span>, <span class="no">flag</span>, <span class="kw">stringsAsFactors</span> <span class="kw">=</span> <span class="fl">FALSE</span>)

<span class="co"># structure of dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">data_exam</span>)
<span class="co">#&gt; 'data.frame':    1000 obs. of  5 variables:</span>
<span class="co">#&gt;  $ id   : chr  "htjuw1" "bnvmk2" "ylqnc3" "xgbhu4" ...</span>
<span class="co">#&gt;  $ year : chr  "2018" "2018" "2018" "2018" ...</span>
<span class="co">#&gt;  $ count: int  3 8 5 9 10 1 6 9 6 5 ...</span>
<span class="co">#&gt;  $ alpha: chr  "h" "u" "k" "w" ...</span>
<span class="co">#&gt;  $ flag : chr  "N" "N" "N" "N" ...</span>

<span class="co"># summary of dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">data_exam</span>)
<span class="co">#&gt;       id                year               count           alpha          </span>
<span class="co">#&gt;  Length:1000        Length:1000        Min.   : 1.000   Length:1000       </span>
<span class="co">#&gt;  Class :character   Class :character   1st Qu.: 3.000   Class :character  </span>
<span class="co">#&gt;  Mode  :character   Mode  :character   Median : 5.000   Mode  :character  </span>
<span class="co">#&gt;                                        Mean   : 5.474                     </span>
<span class="co">#&gt;                                        3rd Qu.: 8.000                     </span>
<span class="co">#&gt;                                        Max.   :10.000                     </span>
<span class="co">#&gt;      flag          </span>
<span class="co">#&gt;  Length:1000       </span>
<span class="co">#&gt;  Class :character  </span>
<span class="co">#&gt;  Mode  :character  </span>
<span class="co">#&gt;                    </span>
<span class="co">#&gt;                    </span>
<span class="co">#&gt; </span></pre></div>
</div>
<div id="clean-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#clean-dataset" class="anchor"></a>Clean dataset</h3>
<p><code><a href="reference/cleanse.data.frame.html">cleanse()</a></code> cleans up the dataset before fitting the classification model.</p>
<p>The function of cleanse() is as follows.:</p>
<ul>
<li>remove variables whose unique value is one</li>
<li>remove variables with high unique rate</li>
<li>converts character variables to factor</li>
<li>remove variables with missing value</li>
</ul>
<div id="cleanse-dataset-with-cleanse" class="section level4">
<h4 class="hasAnchor">
<a href="#cleanse-dataset-with-cleanse" class="anchor"></a>Cleanse dataset with <code>cleanse()</code>
</h4>
<p>For example, we can cleanse all variables in <code>data_exam</code>:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">alookr</span>)
<span class="co">#&gt; Loading required package: ggplot2</span>
<span class="co">#&gt; Loading required package: randomForest</span>
<span class="co">#&gt; randomForest 4.6-14</span>
<span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'randomForest'</span>
<span class="co">#&gt; The following object is masked from 'package:ggplot2':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     margin</span>

<span class="co"># cleansing dataset</span>
<span class="no">newDat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cleanse.data.frame.html">cleanse</a></span>(<span class="no">data_exam</span>)
<span class="co">#&gt; ── Checking unique value ─────────────────────────── unique value is one ──</span>
<span class="co">#&gt; remove variables that unique value is one</span>
<span class="co">#&gt; ● year</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking unique rate ─────────────────────────────── high unique rate ──</span>
<span class="co">#&gt; remove variables with high unique rate</span>
<span class="co">#&gt; ● id = 1000(1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking character variables ─────────────────────── categorical data ──</span>
<span class="co">#&gt; converts character variables to factor</span>
<span class="co">#&gt; ● alpha</span>
<span class="co">#&gt; ● flag</span>

<span class="co"># structure of cleansing dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">newDat</span>)
<span class="co">#&gt; 'data.frame':    1000 obs. of  3 variables:</span>
<span class="co">#&gt;  $ count: int  3 8 5 9 10 1 6 9 6 5 ...</span>
<span class="co">#&gt;  $ alpha: Factor w/ 26 levels "a","b","c","d",..: 8 21 11 23 25 2 14 24 15 12 ...</span>
<span class="co">#&gt;  $ flag : Factor w/ 2 levels "N","Y": 1 1 1 1 2 1 1 1 1 1 ...</span></pre></div>
<ul>
<li>
<code>remove variables whose unique value is one</code> : The year variable has only one value, “2018”. Not needed when fitting the model. So it was removed.</li>
<li>
<code>remove variables with high unique rate</code> : If the number of levels of categorical data is very large, it is not suitable for classification model. In this case, it is highly likely to be an identifier of the data. So, remove the categorical (or character) variable with a high value of the unique rate defined as “number of levels / number of observations”.
<ul>
<li>The unique rate of the id variable with the number of levels of 1000 is 1. This variable is the object of the removal by identifier.</li>
<li>The unique rate of the alpha variable is 0.026 and this variable is also removed.</li>
</ul>
</li>
<li>
<code>converts character variables to factor</code> : The character type flag variable is converted to a factor type.</li>
</ul>
<p>For example, we can not remove the categorical data that is removed by changing the threshold of the <code>unique rate</code>:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="co"># cleansing dataset</span>
<span class="no">newDat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cleanse.data.frame.html">cleanse</a></span>(<span class="no">data_exam</span>, <span class="kw">uniq_thres</span> <span class="kw">=</span> <span class="fl">0.03</span>)
<span class="co">#&gt; ── Checking unique value ─────────────────────────── unique value is one ──</span>
<span class="co">#&gt; remove variables that unique value is one</span>
<span class="co">#&gt; ● year</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking unique rate ─────────────────────────────── high unique rate ──</span>
<span class="co">#&gt; remove variables with high unique rate</span>
<span class="co">#&gt; ● id = 1000(1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking character variables ─────────────────────── categorical data ──</span>
<span class="co">#&gt; converts character variables to factor</span>
<span class="co">#&gt; ● alpha</span>
<span class="co">#&gt; ● flag</span>

<span class="co"># structure of cleansing dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">newDat</span>)
<span class="co">#&gt; 'data.frame':    1000 obs. of  3 variables:</span>
<span class="co">#&gt;  $ count: int  3 8 5 9 10 1 6 9 6 5 ...</span>
<span class="co">#&gt;  $ alpha: Factor w/ 26 levels "a","b","c","d",..: 8 21 11 23 25 2 14 24 15 12 ...</span>
<span class="co">#&gt;  $ flag : Factor w/ 2 levels "N","Y": 1 1 1 1 2 1 1 1 1 1 ...</span></pre></div>
<p>The <code>alpha</code> variable was not removed.</p>
<p>If you do not want to apply a unique rate, you can set the value of the <code>uniq</code> argument to FALSE.:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="co"># cleansing dataset</span>
<span class="no">newDat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cleanse.data.frame.html">cleanse</a></span>(<span class="no">data_exam</span>, <span class="kw">uniq</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; ── Checking character variables ─────────────────────── categorical data ──</span>
<span class="co">#&gt; converts character variables to factor</span>
<span class="co">#&gt; ● id</span>
<span class="co">#&gt; ● year</span>
<span class="co">#&gt; ● alpha</span>
<span class="co">#&gt; ● flag</span>

<span class="co"># structure of cleansing dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">newDat</span>)
<span class="co">#&gt; 'data.frame':    1000 obs. of  5 variables:</span>
<span class="co">#&gt;  $ id   : Factor w/ 1000 levels "abety794","abkoe306",..: 301 59 929 890 904 694 997 465 134 124 ...</span>
<span class="co">#&gt;  $ year : Factor w/ 1 level "2018": 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ count: int  3 8 5 9 10 1 6 9 6 5 ...</span>
<span class="co">#&gt;  $ alpha: Factor w/ 26 levels "a","b","c","d",..: 8 21 11 23 25 2 14 24 15 12 ...</span>
<span class="co">#&gt;  $ flag : Factor w/ 2 levels "N","Y": 1 1 1 1 2 1 1 1 1 1 ...</span></pre></div>
<p>If you do not want to force type conversion of a character variable to factor, you can set the value of the <code>char</code> argument to FALSE.:</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="co"># cleansing dataset</span>
<span class="no">newDat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cleanse.data.frame.html">cleanse</a></span>(<span class="no">data_exam</span>, <span class="kw">char</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; ── Checking unique value ─────────────────────────── unique value is one ──</span>
<span class="co">#&gt; remove variables that unique value is one</span>
<span class="co">#&gt; ● year</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking unique rate ─────────────────────────────── high unique rate ──</span>
<span class="co">#&gt; remove variables with high unique rate</span>
<span class="co">#&gt; ● id = 1000(1)</span>

<span class="co"># structure of cleansing dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">newDat</span>)
<span class="co">#&gt; 'data.frame':    1000 obs. of  3 variables:</span>
<span class="co">#&gt;  $ count: int  3 8 5 9 10 1 6 9 6 5 ...</span>
<span class="co">#&gt;  $ alpha: chr  "h" "u" "k" "w" ...</span>
<span class="co">#&gt;  $ flag : chr  "N" "N" "N" "N" ...</span></pre></div>
<p>If you want to remove a variable that contains missing values, specify the value of the <code>missing</code> argument as TRUE. The following example <strong>removes the flag variable</strong> that contains the missing value.</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="no">data_exam</span>$<span class="no">flag</span>[<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>

<span class="co"># cleansing dataset</span>
<span class="no">newDat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cleanse.data.frame.html">cleanse</a></span>(<span class="no">data_exam</span>, <span class="kw">missing</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; ── Checking missing value ────────────────────────────────── included NA ──</span>
<span class="co">#&gt; remove variables whose included NA</span>
<span class="co">#&gt; ● flag</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking unique value ─────────────────────────── unique value is one ──</span>
<span class="co">#&gt; remove variables that unique value is one</span>
<span class="co">#&gt; ● year</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking unique rate ─────────────────────────────── high unique rate ──</span>
<span class="co">#&gt; remove variables with high unique rate</span>
<span class="co">#&gt; ● id = 1000(1)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking character variables ─────────────────────── categorical data ──</span>
<span class="co">#&gt; converts character variables to factor</span>
<span class="co">#&gt; ● alpha</span>

<span class="co"># structure of cleansing dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">newDat</span>)
<span class="co">#&gt; 'data.frame':    1000 obs. of  2 variables:</span>
<span class="co">#&gt;  $ count: int  3 8 5 9 10 1 6 9 6 5 ...</span>
<span class="co">#&gt;  $ alpha: Factor w/ 26 levels "a","b","c","d",..: 8 21 11 23 25 2 14 24 15 12 ...</span></pre></div>
</div>
</div>
<div id="diagnosis-and-removal-of-highly-correlated-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#diagnosis-and-removal-of-highly-correlated-variables" class="anchor"></a>Diagnosis and removal of highly correlated variables</h3>
<p>In the linear model, there is a multicollinearity if there is a strong correlation between independent variables. So it is better to remove one variable from a pair of variables where the correlation exists.</p>
<p>Even if it is not a linear model, removing one variable from a strongly correlated pair of variables can also reduce the overhead of the operation. It is also easy to interpret the model.</p>
<div id="cleanse-dataset-with-treatment_corr" class="section level4">
<h4 class="hasAnchor">
<a href="#cleanse-dataset-with-treatment_corr" class="anchor"></a>Cleanse dataset with <code>treatment_corr()</code>
</h4>
<p><code><a href="reference/treatment_corr.html">treatment_corr()</a></code> diagnose pairs of highly correlated variables or remove on of them.</p>
<p><code><a href="reference/treatment_corr.html">treatment_corr()</a></code> calculates correlation coefficient of pearson for numerical variable, and correlation coefficient of spearman for categorical variable.</p>
<p>For example, we can diagnosis and removal of highly correlated variables:</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="co"># numerical variable</span>
<span class="no">x1</span> <span class="kw">&lt;-</span> <span class="fl">1</span>:<span class="fl">100</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">12L</span>)
<span class="no">x2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fl">3</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>) * <span class="no">x1</span> + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1234L</span>)
<span class="no">x3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fl">2</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>) * <span class="no">x1</span> + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">1</span>)

<span class="co"># categorical variable</span>
<span class="no">x4</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">20</span>], <span class="kw">time</span> <span class="kw">=</span> <span class="fl">5</span>))
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">100L</span>)
<span class="no">x5</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">20</span> + <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fl">6</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)], <span class="kw">time</span> <span class="kw">=</span> <span class="fl">5</span>))
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">200L</span>)
<span class="no">x6</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">20</span> + <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fl">1</span>:<span class="fl">3</span>, <span class="kw">size</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>)], <span class="kw">time</span> <span class="kw">=</span> <span class="fl">5</span>))
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">300L</span>)
<span class="no">x7</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="no">letters</span>[<span class="fl">1</span>:<span class="fl">5</span>], <span class="kw">size</span> <span class="kw">=</span> <span class="fl">100</span>, <span class="kw">replace</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="no">exam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="no">x1</span>, <span class="no">x2</span>, <span class="no">x3</span>, <span class="no">x4</span>, <span class="no">x5</span>, <span class="no">x6</span>, <span class="no">x7</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">exam</span>)
<span class="co">#&gt; 'data.frame':    100 obs. of  7 variables:</span>
<span class="co">#&gt;  $ x1: int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ x2: num  0.957 5.957 8.957 3.957 4.957 ...</span>
<span class="co">#&gt;  $ x3: num  -0.806 2.194 4.194 6.194 8.194 ...</span>
<span class="co">#&gt;  $ x4: Factor w/ 20 levels "a","b","c","d",..: 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ x5: Factor w/ 17 levels "c","d","e","g",..: 1 2 4 3 5 6 8 7 9 8 ...</span>
<span class="co">#&gt;  $ x6: Factor w/ 14 levels "c","d","e","g",..: 1 2 3 4 5 6 7 6 8 8 ...</span>
<span class="co">#&gt;  $ x7: Factor w/ 5 levels "a","b","c","d",..: 5 4 5 4 4 1 4 3 3 5 ...</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">exam</span>)
<span class="co">#&gt;   x1        x2         x3 x4 x5 x6 x7</span>
<span class="co">#&gt; 1  1 0.9573151 -0.8060313  a  c  c  e</span>
<span class="co">#&gt; 2  2 5.9573151  2.1939687  b  d  d  d</span>
<span class="co">#&gt; 3  3 8.9573151  4.1939687  c  g  e  e</span>
<span class="co">#&gt; 4  4 3.9573151  6.1939687  d  e  g  d</span>
<span class="co">#&gt; 5  5 4.9573151  8.1939687  e  h  h  d</span>
<span class="co">#&gt; 6  6 5.9573151 10.1939687  f  i  i  a</span>

<span class="co"># default case</span>
<span class="no">exam_01</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/treatment_corr.html">treatment_corr</a></span>(<span class="no">exam</span>)
<span class="co">#&gt; * remove variables whose strong correlation (pearson &gt;= 0.8)</span>
<span class="co">#&gt;  - remove x1 : with x3 (0.8072)</span>
<span class="co">#&gt; Warning: `as.tibble()` is deprecated as of tibble 2.0.0.</span>
<span class="co">#&gt; Please use `as_tibble()` instead.</span>
<span class="co">#&gt; The signature and semantics have changed, see `?as_tibble`.</span>
<span class="co">#&gt; This warning is displayed once every 8 hours.</span>
<span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span>
<span class="co">#&gt; * remove variables whose strong correlation (spearman &gt;= 0.8)</span>
<span class="co">#&gt;  - remove x4 : with x5 (0.9823)</span>
<span class="co">#&gt;  - remove x4 : with x6 (0.9955)</span>
<span class="co">#&gt;  - remove x5 : with x6 (0.9853)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">exam_01</span>)
<span class="co">#&gt;          x2         x3 x6 x7</span>
<span class="co">#&gt; 1 0.9573151 -0.8060313  c  e</span>
<span class="co">#&gt; 2 5.9573151  2.1939687  d  d</span>
<span class="co">#&gt; 3 8.9573151  4.1939687  e  e</span>
<span class="co">#&gt; 4 3.9573151  6.1939687  g  d</span>
<span class="co">#&gt; 5 4.9573151  8.1939687  h  d</span>
<span class="co">#&gt; 6 5.9573151 10.1939687  i  a</span>

<span class="co"># not removing variables</span>
<span class="fu"><a href="reference/treatment_corr.html">treatment_corr</a></span>(<span class="no">exam</span>, <span class="kw">treat</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; * remove variables whose strong correlation (pearson &gt;= 0.8)</span>
<span class="co">#&gt;  - remove x1 : with x3 (0.8072)</span>
<span class="co">#&gt; * remove variables whose strong correlation (spearman &gt;= 0.8)</span>
<span class="co">#&gt;  - remove x4 : with x5 (0.9823)</span>
<span class="co">#&gt;  - remove x4 : with x6 (0.9955)</span>
<span class="co">#&gt;  - remove x5 : with x6 (0.9853)</span>

<span class="co"># Set a threshold to detecting variables when correlation greater then 0.9</span>
<span class="fu"><a href="reference/treatment_corr.html">treatment_corr</a></span>(<span class="no">exam</span>, <span class="kw">corr_thres</span> <span class="kw">=</span> <span class="fl">0.9</span>, <span class="kw">treat</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; * remove variables whose strong correlation (spearman &gt;= 0.9)</span>
<span class="co">#&gt;  - remove x4 : with x5 (0.9823)</span>
<span class="co">#&gt;  - remove x4 : with x6 (0.9955)</span>
<span class="co">#&gt;  - remove x5 : with x6 (0.9853)</span>

<span class="co"># not verbose mode</span>
<span class="no">exam_02</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/treatment_corr.html">treatment_corr</a></span>(<span class="no">exam</span>, <span class="kw">verbose</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">exam_02</span>)
<span class="co">#&gt;          x2         x3 x6 x7</span>
<span class="co">#&gt; 1 0.9573151 -0.8060313  c  e</span>
<span class="co">#&gt; 2 5.9573151  2.1939687  d  d</span>
<span class="co">#&gt; 3 8.9573151  4.1939687  e  e</span>
<span class="co">#&gt; 4 3.9573151  6.1939687  g  d</span>
<span class="co">#&gt; 5 4.9573151  8.1939687  h  d</span>
<span class="co">#&gt; 6 5.9573151 10.1939687  i  a</span></pre></div>
<ul>
<li>
<code>remove variables whose strong correlation</code> : x1, x4, x5 are removed.</li>
</ul>
</div>
</div>
</div>
<div id="split-the-data-into-a-train-set-and-a-test-set" class="section level2">
<h2 class="hasAnchor">
<a href="#split-the-data-into-a-train-set-and-a-test-set" class="anchor"></a>Split the data into a train set and a test set</h2>
<div id="data-credit-card-default-data" class="section level3">
<h3 class="hasAnchor">
<a href="#data-credit-card-default-data" class="anchor"></a>Data: Credit Card Default Data</h3>
<p><code>Default</code> of <code>ISLR package</code> is a simulated data set containing information on ten thousand customers. The aim here is to predict which customers will default on their credit card debt.</p>
<p>A data frame with 10000 observations on the following 4 variables.:</p>
<ul>
<li>
<code>default</code> : factor. A factor with levels No and Yes indicating whether the customer defaulted on their debt</li>
<li>
<code>student</code>: factor. A factor with levels No and Yes indicating whether the customer is a student</li>
<li>
<code>balance</code>: numeric. The average balance that the customer has remaining on their credit card after making their monthly payment</li>
<li>
<code>income</code> : numeric. Income of customer</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb12"><pre class="r"><span class="co"># Credit Card Default Data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw pkg">ISLR</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span>)
<span class="co">#&gt;   default student   balance    income</span>
<span class="co">#&gt; 1      No      No  729.5265 44361.625</span>
<span class="co">#&gt; 2      No     Yes  817.1804 12106.135</span>
<span class="co">#&gt; 3      No      No 1073.5492 31767.139</span>
<span class="co">#&gt; 4      No      No  529.2506 35704.494</span>
<span class="co">#&gt; 5      No      No  785.6559 38463.496</span>
<span class="co">#&gt; 6      No     Yes  919.5885  7491.559</span>

<span class="co"># structure of dataset</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="kw pkg">ISLR</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span>)
<span class="co">#&gt; 'data.frame':    10000 obs. of  4 variables:</span>
<span class="co">#&gt;  $ default: Factor w/ 2 levels "No","Yes": 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="co">#&gt;  $ student: Factor w/ 2 levels "No","Yes": 1 2 1 1 1 2 1 2 1 1 ...</span>
<span class="co">#&gt;  $ balance: num  730 817 1074 529 786 ...</span>
<span class="co">#&gt;  $ income : num  44362 12106 31767 35704 38463 ...</span>

<span class="co"># summary of dataset</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="kw pkg">ISLR</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span>)
<span class="co">#&gt;  default    student       balance           income     </span>
<span class="co">#&gt;  No :9667   No :7056   Min.   :   0.0   Min.   :  772  </span>
<span class="co">#&gt;  Yes: 333   Yes:2944   1st Qu.: 481.7   1st Qu.:21340  </span>
<span class="co">#&gt;                        Median : 823.6   Median :34553  </span>
<span class="co">#&gt;                        Mean   : 835.4   Mean   :33517  </span>
<span class="co">#&gt;                        3rd Qu.:1166.3   3rd Qu.:43808  </span>
<span class="co">#&gt;                        Max.   :2654.3   Max.   :73554</span></pre></div>
</div>
<div id="split-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#split-dataset" class="anchor"></a>Split dataset</h3>
<p><code><a href="reference/split_by.data.frame.html">split_by()</a></code> splits the data.frame or tbl_df into a training set and a test set.</p>
<div id="split-dataset-with-split_by" class="section level4">
<h4 class="hasAnchor">
<a href="#split-dataset-with-split_by" class="anchor"></a>Split dataset with <code>split_by()</code>
</h4>
<p>The <code>split_df</code> class is created, which contains the split information and criteria to separate the training and the test set.</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">alookr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="co"># Generate data for the example</span>
<span class="no">sb</span> <span class="kw">&lt;-</span> <span class="kw pkg">ISLR</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/split_by.data.frame.html">split_by</a></span>(<span class="no">default</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">6534</span>)

<span class="no">sb</span>
<span class="co">#&gt; # A tibble: 10,000 x 5</span>
<span class="co">#&gt; # Groups:   split_flag [2]</span>
<span class="co">#&gt;    default student balance income split_flag</span>
<span class="co">#&gt;    &lt;fct&gt;   &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;     </span>
<span class="co">#&gt;  1 No      No         730. 44362. train     </span>
<span class="co">#&gt;  2 No      Yes        817. 12106. train     </span>
<span class="co">#&gt;  3 No      No        1074. 31767. train     </span>
<span class="co">#&gt;  4 No      No         529. 35704. train     </span>
<span class="co">#&gt;  5 No      No         786. 38463. test      </span>
<span class="co">#&gt;  6 No      Yes        920.  7492. train     </span>
<span class="co">#&gt;  7 No      No         826. 24905. test      </span>
<span class="co">#&gt;  8 No      Yes        809. 17600. train     </span>
<span class="co">#&gt;  9 No      No        1161. 37469. train     </span>
<span class="co">#&gt; 10 No      No           0  29275. train     </span>
<span class="co">#&gt; # … with 9,990 more rows</span></pre></div>
<p>The attributes of the <code>split_df</code> class are as follows.:</p>
<ul>
<li>split_seed : integer. random seed used for splitting</li>
<li>target : character. the name of the target variable</li>
<li>binary : logical. whether the target variable is binary class</li>
<li>minority : character. the name of the minority class</li>
<li>majority : character. the name of the majority class</li>
<li>minority_rate : numeric. the rate of the minority class</li>
<li>majority_rate : numeric. the rate of the majority class</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb14"><pre class="r"><span class="no">attr_names</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">sb</span>))
<span class="no">attr_names</span>
<span class="co">#&gt;  [1] "names"         "row.names"     "groups"        "class"        </span>
<span class="co">#&gt;  [5] "split_seed"    "target"        "binary"        "minority"     </span>
<span class="co">#&gt;  [9] "majority"      "minority_rate" "majority_rate"</span>

<span class="no">sb_attr</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span>(<span class="no">sb</span>)

<span class="co"># The third property, row.names, is excluded from the output because its length is very long.</span>
<span class="no">sb_attr</span>[!<span class="no">attr_names</span> <span class="kw">%in%</span> <span class="st">"row.names"</span>]
<span class="co">#&gt; $names</span>
<span class="co">#&gt; [1] "default"    "student"    "balance"    "income"     "split_flag"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $groups</span>
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   split_flag       .rows</span>
<span class="co">#&gt; * &lt;chr&gt;      &lt;list&lt;int&gt;&gt;</span>
<span class="co">#&gt; 1 test           [3,000]</span>
<span class="co">#&gt; 2 train          [7,000]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] "split_df"   "grouped_df" "tbl_df"     "tbl"        "data.frame"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $split_seed</span>
<span class="co">#&gt; [1] 6534</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $target</span>
<span class="co">#&gt;   default </span>
<span class="co">#&gt; "default" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $binary</span>
<span class="co">#&gt; [1] TRUE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $minority</span>
<span class="co">#&gt; [1] "Yes"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $majority</span>
<span class="co">#&gt; [1] "No"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $minority_rate</span>
<span class="co">#&gt;    Yes </span>
<span class="co">#&gt; 0.0333 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $majority_rate</span>
<span class="co">#&gt;     No </span>
<span class="co">#&gt; 0.9667</span></pre></div>
<p><code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> summarizes the information of two datasets splitted by <code><a href="reference/split_by.data.frame.html">split_by()</a></code>.</p>
<div class="sourceCode" id="cb15"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">sb</span>)
<span class="co">#&gt; ** Split train/test set information **</span>
<span class="co">#&gt;  + random seed        :  6534 </span>
<span class="co">#&gt;  + split data            </span>
<span class="co">#&gt;     - train set count :  7000 </span>
<span class="co">#&gt;     - test set count  :  3000 </span>
<span class="co">#&gt;  + target variable    :  default </span>
<span class="co">#&gt;     - minority class  :  Yes (0.033300)</span>
<span class="co">#&gt;     - majority class  :  No (0.966700)</span></pre></div>
</div>
</div>
<div id="compare-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#compare-dataset" class="anchor"></a>Compare dataset</h3>
<p>Train data and test data should be similar. If the two datasets are not similar, the performance of the predictive model may be reduced.</p>
<p><code>alookr</code> provides a function to compare the similarity between train dataset and test dataset.</p>
<p>If the two data sets are not similar, the train dataset and test dataset should be splitted again from the original data.</p>
<div id="comparison-of-categorical-variables-with-compare_target_category" class="section level4">
<h4 class="hasAnchor">
<a href="#comparison-of-categorical-variables-with-compare_target_category" class="anchor"></a>Comparison of categorical variables with <code>compare_target_category()</code>
</h4>
<p>Compare the statistics of the categorical variables of the train set and test set included in the “split_df” class.</p>
<div class="sourceCode" id="cb16"><pre class="r"><span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_target_category.html">compare_target_category</a></span>()
<span class="co">#&gt; # A tibble: 4 x 5</span>
<span class="co">#&gt;   variable level train  test abs_diff</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 default  No    96.7  96.7   0.00476</span>
<span class="co">#&gt; 2 default  Yes    3.33  3.33  0.00476</span>
<span class="co">#&gt; 3 student  No    70.0  71.8   1.77   </span>
<span class="co">#&gt; 4 student  Yes   30.0  28.2   1.77</span>

<span class="co"># compare variables that are character data types.</span>
<span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_target_category.html">compare_target_category</a></span>(<span class="kw">add_character</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; # A tibble: 4 x 5</span>
<span class="co">#&gt;   variable level train  test abs_diff</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 default  No    96.7  96.7   0.00476</span>
<span class="co">#&gt; 2 default  Yes    3.33  3.33  0.00476</span>
<span class="co">#&gt; 3 student  No    70.0  71.8   1.77   </span>
<span class="co">#&gt; 4 student  Yes   30.0  28.2   1.77</span>

<span class="co"># display marginal</span>
<span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_target_category.html">compare_target_category</a></span>(<span class="kw">margin</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; # A tibble: 6 x 5</span>
<span class="co">#&gt;   variable level    train   test abs_diff</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;fct&gt;    &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 default  No       96.7   96.7   0.00476</span>
<span class="co">#&gt; 2 default  Yes       3.33   3.33  0.00476</span>
<span class="co">#&gt; 3 default  &lt;Total&gt; 100    100     0.00952</span>
<span class="co">#&gt; 4 student  No       70.0   71.8   1.77   </span>
<span class="co">#&gt; 5 student  Yes      30.0   28.2   1.77   </span>
<span class="co">#&gt; 6 student  &lt;Total&gt; 100    100     3.54</span>

<span class="co"># student variable only</span>
<span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_target_category.html">compare_target_category</a></span>(<span class="no">student</span>)
<span class="co">#&gt; # A tibble: 2 x 5</span>
<span class="co">#&gt;   variable level train  test abs_diff</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 student  No     70.0  71.8     1.77</span>
<span class="co">#&gt; 2 student  Yes    30.0  28.2     1.77</span>

<span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_target_category.html">compare_target_category</a></span>(<span class="no">student</span>, <span class="kw">margin</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; # A tibble: 3 x 5</span>
<span class="co">#&gt;   variable level   train  test abs_diff</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;fct&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 student  No       70.0  71.8     1.77</span>
<span class="co">#&gt; 2 student  Yes      30.0  28.2     1.77</span>
<span class="co">#&gt; 3 student  &lt;Total&gt; 100   100       3.54</span></pre></div>
<p>compare_target_category() returns tbl_df, where the variables have the following.:</p>
<ul>
<li>variable : character. categorical variable name</li>
<li>level : factor. level of categorical variables</li>
<li>train : numeric. the relative frequency of the level in the train set</li>
<li>test : numeric. the relative frequency of the level in the test set</li>
<li>abs_diff : numeric. the absolute value of the difference between two relative frequencies</li>
</ul>
</div>
<div id="comparison-of-numeric-variables-with-compare_target_numeric" class="section level4">
<h4 class="hasAnchor">
<a href="#comparison-of-numeric-variables-with-compare_target_numeric" class="anchor"></a>Comparison of numeric variables with <code>compare_target_numeric()</code>
</h4>
<p>Compare the statistics of the numerical variables of the train set and test set included in the “split_df” class.</p>
<div class="sourceCode" id="cb17"><pre class="r"><span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_target_numeric.html">compare_target_numeric</a></span>()
<span class="co">#&gt; # A tibble: 2 x 7</span>
<span class="co">#&gt;   variable train_mean test_mean train_sd test_sd train_z test_z</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 balance        836.      834.     487.    477.    1.72   1.75</span>
<span class="co">#&gt; 2 income       33446.    33684.   13437.  13101.    2.49   2.57</span>

<span class="co"># balance variable only</span>
<span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_target_numeric.html">compare_target_numeric</a></span>(<span class="no">balance</span>)
<span class="co">#&gt; # A tibble: 1 x 7</span>
<span class="co">#&gt;   variable train_mean test_mean train_sd test_sd train_z test_z</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 balance        836.      834.     487.    477.    1.72   1.75</span></pre></div>
<p>compare_target_numeric() returns tbl_df, where the variables have the following.:</p>
<ul>
<li>variable : character. numeric variable name</li>
<li>train_mean : numeric. arithmetic mean of train set</li>
<li>test_mean : numeric. arithmetic mean of test set</li>
<li>train_sd : numeric. standard deviation of train set</li>
<li>test_sd : numeric. standard deviation of test set</li>
<li>train_z : numeric. the arithmetic mean of the train set divided by the standard deviation</li>
<li>test_z : numeric. the arithmetic mean of the test set divided by the standard deviation</li>
</ul>
</div>
<div id="comparison-plot-with-compare_plot" class="section level4">
<h4 class="hasAnchor">
<a href="#comparison-plot-with-compare_plot" class="anchor"></a>Comparison plot with <code>compare_plot()</code>
</h4>
<p>Plot compare information of the train set and test set included in the “split_df” class.</p>
<div class="sourceCode" id="cb18"><pre class="r"><span class="co"># income variable only</span>
<span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_plot.html">compare_plot</a></span>(<span class="st">"income"</span>)</pre></div>
<p><img src="reference/figures/README-compare_plot-1.png"><!-- --></p>
<div class="sourceCode" id="cb19"><pre class="r">
<span class="co"># all varibales</span>
<span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_plot.html">compare_plot</a></span>()</pre></div>
<p><img src="reference/figures/README-compare_plot-2.png"><!-- --><img src="reference/figures/README-compare_plot-3.png"><!-- --><img src="reference/figures/README-compare_plot-4.png"><!-- --><img src="reference/figures/README-compare_plot-5.png"><!-- --></p>
</div>
<div id="diagnosis-of-train-set-and-test-set-with-compare_diag" class="section level4">
<h4 class="hasAnchor">
<a href="#diagnosis-of-train-set-and-test-set-with-compare_diag" class="anchor"></a>Diagnosis of train set and test set with <code>compare_diag()</code>
</h4>
<p>Diagnosis of similarity between datasets splitted by train set and set included in the “split_df” class.</p>
<div class="sourceCode" id="cb20"><pre class="r"><span class="no">defaults</span> <span class="kw">&lt;-</span> <span class="kw pkg">ISLR</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span>
<span class="no">defaults</span>$<span class="no">id</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span>(<span class="no">defaults</span>))

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)
<span class="no">defaults</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span>(<span class="no">defaults</span>)), <span class="fl">3</span>), <span class="st">"student"</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">2</span>)
<span class="no">defaults</span>[<span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">NROW</a></span>(<span class="no">defaults</span>)), <span class="fl">10</span>), <span class="st">"balance"</span>] <span class="kw">&lt;-</span> <span class="fl">NA</span>

<span class="no">sb_2</span> <span class="kw">&lt;-</span> <span class="no">defaults</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/split_by.data.frame.html">split_by</a></span>(<span class="no">default</span>)

<span class="no">sb_2</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_diag.html">compare_diag</a></span>()
<span class="co">#&gt; * Detected diagnose missing value</span>
<span class="co">#&gt;  - student</span>
<span class="co">#&gt;  - balance</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; * Detected diagnose missing levels</span>
<span class="co">#&gt;  - student</span>
<span class="co">#&gt; $missing_value</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   variables train_misscount train_missrate test_missrate</span>
<span class="co">#&gt;   &lt;chr&gt;               &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 student                 3         0.0429        NA    </span>
<span class="co">#&gt; 2 balance                 5         0.0714         0.167</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $single_value</span>
<span class="co">#&gt; # A tibble: 0 x 3</span>
<span class="co">#&gt; # … with 3 variables: variables &lt;chr&gt;, train_uniq &lt;lgl&gt;, test_uniq &lt;lgl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $uniq_rate</span>
<span class="co">#&gt; # A tibble: 0 x 5</span>
<span class="co">#&gt; # … with 5 variables: variables &lt;chr&gt;, train_uniqcount &lt;int&gt;,</span>
<span class="co">#&gt; #   train_uniqrate &lt;dbl&gt;, test_uniqcount &lt;int&gt;, test_uniqrate &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $missing_level</span>
<span class="co">#&gt; # A tibble: 1 x 4</span>
<span class="co">#&gt;   variables n_levels train_missing_nlevel test_missing_nlevel</span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;int&gt;                &lt;int&gt;               &lt;int&gt;</span>
<span class="co">#&gt; 1 student          3                    0                   1</span>

<span class="no">sb_2</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_diag.html">compare_diag</a></span>(<span class="kw">add_character</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="co">#&gt; * Detected diagnose missing value</span>
<span class="co">#&gt;  - student</span>
<span class="co">#&gt;  - balance</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; * Detected diagnose missing levels</span>
<span class="co">#&gt;  - student</span>
<span class="co">#&gt; $missing_value</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   variables train_misscount train_missrate test_missrate</span>
<span class="co">#&gt;   &lt;chr&gt;               &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 student                 3         0.0429        NA    </span>
<span class="co">#&gt; 2 balance                 5         0.0714         0.167</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $single_value</span>
<span class="co">#&gt; # A tibble: 0 x 3</span>
<span class="co">#&gt; # … with 3 variables: variables &lt;chr&gt;, train_uniq &lt;lgl&gt;, test_uniq &lt;lgl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $uniq_rate</span>
<span class="co">#&gt; # A tibble: 0 x 5</span>
<span class="co">#&gt; # … with 5 variables: variables &lt;chr&gt;, train_uniqcount &lt;int&gt;,</span>
<span class="co">#&gt; #   train_uniqrate &lt;dbl&gt;, test_uniqcount &lt;int&gt;, test_uniqrate &lt;dbl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $missing_level</span>
<span class="co">#&gt; # A tibble: 1 x 4</span>
<span class="co">#&gt;   variables n_levels train_missing_nlevel test_missing_nlevel</span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;int&gt;                &lt;int&gt;               &lt;int&gt;</span>
<span class="co">#&gt; 1 student          3                    0                   1</span>

<span class="no">sb_2</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_diag.html">compare_diag</a></span>(<span class="kw">uniq_thres</span> <span class="kw">=</span> <span class="fl">0.0005</span>)
<span class="co">#&gt; * Detected diagnose missing value</span>
<span class="co">#&gt;  - student</span>
<span class="co">#&gt;  - balance</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; * Detected diagnose many unique value</span>
<span class="co">#&gt;  - default</span>
<span class="co">#&gt;  - student</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; * Detected diagnose missing levels</span>
<span class="co">#&gt;  - student</span>
<span class="co">#&gt; $missing_value</span>
<span class="co">#&gt; # A tibble: 2 x 4</span>
<span class="co">#&gt;   variables train_misscount train_missrate test_missrate</span>
<span class="co">#&gt;   &lt;chr&gt;               &lt;int&gt;          &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 student                 3         0.0429        NA    </span>
<span class="co">#&gt; 2 balance                 5         0.0714         0.167</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $single_value</span>
<span class="co">#&gt; # A tibble: 0 x 3</span>
<span class="co">#&gt; # … with 3 variables: variables &lt;chr&gt;, train_uniq &lt;lgl&gt;, test_uniq &lt;lgl&gt;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $uniq_rate</span>
<span class="co">#&gt; # A tibble: 2 x 5</span>
<span class="co">#&gt;   variables train_uniqcount train_uniqrate test_uniqcount test_uniqrate</span>
<span class="co">#&gt;   &lt;chr&gt;               &lt;int&gt;          &lt;dbl&gt;          &lt;int&gt;         &lt;dbl&gt;</span>
<span class="co">#&gt; 1 default                NA             NA              2      0.000667</span>
<span class="co">#&gt; 2 student                NA             NA              2      0.000667</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $missing_level</span>
<span class="co">#&gt; # A tibble: 1 x 4</span>
<span class="co">#&gt;   variables n_levels train_missing_nlevel test_missing_nlevel</span>
<span class="co">#&gt;   &lt;chr&gt;        &lt;int&gt;                &lt;int&gt;               &lt;int&gt;</span>
<span class="co">#&gt; 1 student          3                    0                   1</span></pre></div>
</div>
</div>
<div id="extract-traintest-dataset" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-traintest-dataset" class="anchor"></a>Extract train/test dataset</h3>
<p>If you compare the train set with the test set and find that the two datasets are similar, extract the data from the split_df object.</p>
<div id="extract-train-set-or-test-set-with-extract_set" class="section level4">
<h4 class="hasAnchor">
<a href="#extract-train-set-or-test-set-with-extract_set" class="anchor"></a>Extract train set or test set with <code>extract_set()</code>
</h4>
<p>Extract train set or test set from split_df class object.</p>
<div class="sourceCode" id="cb21"><pre class="r"><span class="no">train</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/extract_set.html">extract_set</a></span>(<span class="kw">set</span> <span class="kw">=</span> <span class="st">"train"</span>)

<span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/extract_set.html">extract_set</a></span>(<span class="kw">set</span> <span class="kw">=</span> <span class="st">"test"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">train</span>)
<span class="co">#&gt; [1] 7000    4</span>

<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(<span class="no">test</span>)
<span class="co">#&gt; [1] 3000    4</span></pre></div>
</div>
<div id="extract-the-data-to-fit-the-model-with-sampling_target" class="section level4">
<h4 class="hasAnchor">
<a href="#extract-the-data-to-fit-the-model-with-sampling_target" class="anchor"></a>Extract the data to fit the model with <code>sampling_target()</code>
</h4>
<p>In a target class, the ratio of the majority class to the minority class is not similar and the ratio of the minority class is very small, which is called the <code>imbalanced class</code>.</p>
<p>If target variable is an imbalanced class, the characteristics of the majority class are actively reflected in the model. This model implies an error in predicting the minority class as the majority class. So we have to make the train dataset a balanced class.</p>
<p><code><a href="reference/sampling_target.html">sampling_target()</a></code> performs sampling on the train set of split_df to resolve the imbalanced class.</p>
<div class="sourceCode" id="cb22"><pre class="r"><span class="co"># under-sampling with random seed</span>
<span class="no">under</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1234L</span>)

<span class="no">under</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">default</span>)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   default     n</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 No        233</span>
<span class="co">#&gt; 2 Yes       233</span>

<span class="co"># under-sampling with random seed, and minority class frequency is 40%</span>
<span class="no">under40</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1234L</span>, <span class="kw">perc</span> <span class="kw">=</span> <span class="fl">40</span>)

<span class="no">under40</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">default</span>)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   default     n</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 No        349</span>
<span class="co">#&gt; 2 Yes       233</span>

<span class="co"># over-sampling with random seed</span>
<span class="no">over</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ubOver"</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1234L</span>)
<span class="co">#&gt; Warning: `as.tbl()` is deprecated as of dplyr 1.0.0.</span>
<span class="co">#&gt; Please use `tibble::as_tibble()` instead.</span>
<span class="co">#&gt; This warning is displayed once every 8 hours.</span>
<span class="co">#&gt; Call `lifecycle::last_warnings()` to see where this warning was generated.</span>

<span class="no">over</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">default</span>)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   default     n</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 No       6767</span>
<span class="co">#&gt; 2 Yes      6767</span>

<span class="co"># over-sampling with random seed, and k = 10</span>
<span class="no">over10</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ubOver"</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1234L</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">10</span>)

<span class="no">over10</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">default</span>)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   default     n</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 No       6767</span>
<span class="co">#&gt; 2 Yes      2330</span>

<span class="co"># SMOTE with random seed</span>
<span class="no">smote</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ubSMOTE"</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1234L</span>)

<span class="no">smote</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">default</span>)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   default     n</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 No        932</span>
<span class="co">#&gt; 2 Yes       699</span>

<span class="co"># SMOTE with random seed, and perc.under = 250</span>
<span class="no">smote250</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ubSMOTE"</span>, <span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1234L</span>, <span class="kw">perc.under</span> <span class="kw">=</span> <span class="fl">250</span>)

<span class="no">smote250</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span>(<span class="no">default</span>)
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   default     n</span>
<span class="co">#&gt;   &lt;fct&gt;   &lt;int&gt;</span>
<span class="co">#&gt; 1 No       1165</span>
<span class="co">#&gt; 2 Yes       699</span></pre></div>
<p>The argument that specifies the sampling method in sampling_target () is method. “ubUnder” is under-sampling, and “ubOver” is over-sampling, “ubSMOTE” is SMOTE(Synthetic Minority Over-sampling TEchnique).</p>
</div>
</div>
</div>
<div id="modeling-and-evaluate-predict" class="section level2">
<h2 class="hasAnchor">
<a href="#modeling-and-evaluate-predict" class="anchor"></a>Modeling and Evaluate, Predict</h2>
<div id="data-wisconsin-breast-cancer-data" class="section level3">
<h3 class="hasAnchor">
<a href="#data-wisconsin-breast-cancer-data" class="anchor"></a>Data: Wisconsin Breast Cancer Data</h3>
<p><code>BreastCancer</code> of <code>mlbench package</code> is a breast cancer data. The objective is to identify each of a number of benign or malignant classes.</p>
<p>A data frame with 699 observations on 11 variables, one being a character variable, 9 being ordered or nominal, and 1 target class.:</p>
<ul>
<li>
<code>Id</code> : character. Sample code number</li>
<li>
<code>Cl.thickness</code> : ordered factor. Clump Thickness</li>
<li>
<code>Cell.size</code> : ordered factor. Uniformity of Cell Size</li>
<li>
<code>Cell.shape</code> : ordered factor. Uniformity of Cell Shape</li>
<li>
<code>Marg.adhesion</code> : ordered factor. Marginal Adhesion</li>
<li>
<code>Epith.c.size</code> : ordered factor. Single Epithelial Cell Size</li>
<li>
<code>Bare.nuclei</code> : factor. Bare Nuclei</li>
<li>
<code>Bl.cromatin</code> : factor. Bland Chromatin</li>
<li>
<code>Normal.nucleoli</code> : factor. Normal Nucleoli</li>
<li>
<code>Mitoses</code> : factor. Mitoses</li>
<li>
<code>Class</code> : factor. Class. level is <code>benign</code> and <code>malignant</code>.</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb23"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mlbench</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">BreastCancer</span>)

<span class="co"># class of each variables</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">BreastCancer</span>, <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">x</span>)[<span class="fl">1</span>])
<span class="co">#&gt;              Id    Cl.thickness       Cell.size      Cell.shape   Marg.adhesion </span>
<span class="co">#&gt;     "character"       "ordered"       "ordered"       "ordered"       "ordered" </span>
<span class="co">#&gt;    Epith.c.size     Bare.nuclei     Bl.cromatin Normal.nucleoli         Mitoses </span>
<span class="co">#&gt;       "ordered"        "factor"        "factor"        "factor"        "factor" </span>
<span class="co">#&gt;           Class </span>
<span class="co">#&gt;        "factor"</span></pre></div>
</div>
<div id="preperation-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#preperation-the-data" class="anchor"></a>Preperation the data</h3>
<p>Perform data preprocessing as follows.:</p>
<ul>
<li>Find and imputate variables that contain missing values.</li>
<li>Split the data into a train set and a test set.</li>
<li>To solve the imbalanced class, perform sampling in the train set of raw data.</li>
<li>Cleansing the dataset for classification modeling.</li>
</ul>
<div id="fix-the-missing-value-with-dlookrimputate_na" class="section level4">
<h4 class="hasAnchor">
<a href="#fix-the-missing-value-with-dlookrimputate_na" class="anchor"></a>Fix the missing value with <code>dlookr::imputate_na()</code>
</h4>
<p>find the variables that include missing value. and imputate the missing value using imputate_na() in dlookr package.</p>
<div class="sourceCode" id="cb24"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dlookr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="co"># variable that have a missing value</span>
<span class="fu"><a href="https://rdrr.io/pkg/dlookr/man/diagnose.data.frame.html">diagnose</a></span>(<span class="no">BreastCancer</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">missing_count</span> <span class="kw">&gt;</span> <span class="fl">0</span>)
<span class="co">#&gt; # A tibble: 1 x 6</span>
<span class="co">#&gt;   variables   types  missing_count missing_percent unique_count unique_rate</span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;          &lt;int&gt;           &lt;dbl&gt;        &lt;int&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 Bare.nuclei factor            16            2.29           11      0.0157</span>

<span class="co"># imputation of missing value</span>
<span class="no">breastCancer</span> <span class="kw">&lt;-</span> <span class="no">BreastCancer</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">Bare.nuclei</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dlookr/man/imputate_na.html">imputate_na</a></span>(<span class="no">BreastCancer</span>, <span class="no">Bare.nuclei</span>, <span class="no">Class</span>,
                         <span class="kw">method</span> <span class="kw">=</span> <span class="st">"mice"</span>, <span class="kw">no_attrs</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">print_flag</span> <span class="kw">=</span> <span class="fl">FALSE</span>))</pre></div>
</div>
</div>
<div id="split-data-set" class="section level3">
<h3 class="hasAnchor">
<a href="#split-data-set" class="anchor"></a>Split data set</h3>
<div id="splits-the-dataset-into-a-train-set-and-a-test-set-with-split_by" class="section level4">
<h4 class="hasAnchor">
<a href="#splits-the-dataset-into-a-train-set-and-a-test-set-with-split_by" class="anchor"></a>Splits the dataset into a train set and a test set with <code>split_by()</code>
</h4>
<p><code><a href="reference/split_by.data.frame.html">split_by()</a></code> in the alookr package splits the dataset into a train set and a test set.</p>
<p>The ratio argument of the <code><a href="reference/split_by.data.frame.html">split_by()</a></code> function specifies the ratio of the train set.</p>
<p><code><a href="reference/split_by.data.frame.html">split_by()</a></code> creates a class object named split_df.</p>
<div class="sourceCode" id="cb25"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">alookr</span>)

<span class="co"># split the data into a train set and a test set by default arguments</span>
<span class="no">sb</span> <span class="kw">&lt;-</span> <span class="no">breastCancer</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/split_by.data.frame.html">split_by</a></span>(<span class="kw">target</span> <span class="kw">=</span> <span class="no">Class</span>)

<span class="co"># show the class name</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span>(<span class="no">sb</span>)
<span class="co">#&gt; [1] "split_df"   "grouped_df" "tbl_df"     "tbl"        "data.frame"</span>

<span class="co"># split the data into a train set and a test set by ratio = 0.6</span>
<span class="no">tmp</span> <span class="kw">&lt;-</span> <span class="no">breastCancer</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/split_by.data.frame.html">split_by</a></span>(<span class="no">Class</span>, <span class="kw">ratio</span> <span class="kw">=</span> <span class="fl">0.6</span>)</pre></div>
<p>The <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function displays the following useful information about the split_df object:</p>
<ul>
<li>random seed : The random seed is the random seed used internally to separate the data</li>
<li>split data : Information of splited data
<ul>
<li>train set count : number of train set</li>
<li>test set count : number of test set</li>
</ul>
</li>
<li>target variable : Target variable name
<ul>
<li>minority class : name and ratio(In parentheses) of minority class</li>
<li>majority class : name and ratio(In parentheses) of majority class</li>
</ul>
</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb26"><pre class="r"><span class="co"># summary() display the some information</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">sb</span>)
<span class="co">#&gt; ** Split train/test set information **</span>
<span class="co">#&gt;  + random seed        :  50785 </span>
<span class="co">#&gt;  + split data            </span>
<span class="co">#&gt;     - train set count :  489 </span>
<span class="co">#&gt;     - test set count  :  210 </span>
<span class="co">#&gt;  + target variable    :  Class </span>
<span class="co">#&gt;     - minority class  :  malignant (0.344778)</span>
<span class="co">#&gt;     - majority class  :  benign (0.655222)</span>

<span class="co"># summary() display the some information</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">tmp</span>)
<span class="co">#&gt; ** Split train/test set information **</span>
<span class="co">#&gt;  + random seed        :  60620 </span>
<span class="co">#&gt;  + split data            </span>
<span class="co">#&gt;     - train set count :  419 </span>
<span class="co">#&gt;     - test set count  :  280 </span>
<span class="co">#&gt;  + target variable    :  Class </span>
<span class="co">#&gt;     - minority class  :  malignant (0.344778)</span>
<span class="co">#&gt;     - majority class  :  benign (0.655222)</span></pre></div>
</div>
<div id="check-missing-levels-in-the-train-set" class="section level4">
<h4 class="hasAnchor">
<a href="#check-missing-levels-in-the-train-set" class="anchor"></a>Check missing levels in the train set</h4>
<p>In the case of categorical variables, when a train set and a test set are separated, a specific level may be missing from the train set.</p>
<p>In this case, there is no problem when fitting the model, but an error occurs when predicting with the model you created. Therefore, preprocessing is performed to avoid missing data preprocessing.</p>
<p>In the following example, fortunately, there is no categorical variable that contains the missing levels in the train set.</p>
<div class="sourceCode" id="cb27"><pre class="r"><span class="co"># list of categorical variables in the train set that contain missing levels</span>
<span class="no">nolevel_in_train</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/compare_target_category.html">compare_target_category</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">train</span> <span class="kw">==</span> <span class="fl">0</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">variable</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>() <span class="kw">%&gt;%</span>
  <span class="no">pull</span>

<span class="no">nolevel_in_train</span>
<span class="co">#&gt; character(0)</span>

<span class="co"># if any of the categorical variables in the train set contain a missing level, </span>
<span class="co"># split them again.</span>
<span class="kw">while</span> (<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">nolevel_in_train</span>) <span class="kw">&gt;</span> <span class="fl">0</span>) {
  <span class="no">sb</span> <span class="kw">&lt;-</span> <span class="no">breastCancer</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/split_by.data.frame.html">split_by</a></span>(<span class="no">Class</span>)

  <span class="no">nolevel_in_train</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/compare_target_category.html">compare_target_category</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">train</span> <span class="kw">==</span> <span class="fl">0</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">variable</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>() <span class="kw">%&gt;%</span>
    <span class="no">pull</span>
}</pre></div>
</div>
</div>
<div id="handling-the-imbalanced-classes-data-with-sampling_target" class="section level3">
<h3 class="hasAnchor">
<a href="#handling-the-imbalanced-classes-data-with-sampling_target" class="anchor"></a>Handling the imbalanced classes data with <code>sampling_target()</code>
</h3>
<div id="issue-of-imbalanced-classes-data" class="section level4">
<h4 class="hasAnchor">
<a href="#issue-of-imbalanced-classes-data" class="anchor"></a>Issue of imbalanced classes data</h4>
<p>Imbalanced classes(levels) data means that the number of one level of the frequency of the target variable is relatively small. In general, the proportion of positive classes is relatively small. For example, in the model of predicting spam, the class of interest spam is less than non-spam.</p>
<p>Imbalanced classes data is a common problem in machine learning classification.</p>
<p><code><a href="https://rdrr.io/r/base/table.html">table()</a></code> and <code><a href="https://rdrr.io/r/base/proportions.html">prop.table()</a></code> are traditionally useful functions for diagnosing imbalanced classes data. However, alookr’s <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> is simpler and provides more information.</p>
<div class="sourceCode" id="cb28"><pre class="r"><span class="co"># train set frequency table - imbalanced classes data</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">sb</span>$<span class="no">Class</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;    benign malignant </span>
<span class="co">#&gt;       458       241</span>

<span class="co"># train set relative frequency table - imbalanced classes data</span>
<span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">sb</span>$<span class="no">Class</span>))
<span class="co">#&gt; </span>
<span class="co">#&gt;    benign malignant </span>
<span class="co">#&gt; 0.6552217 0.3447783</span>

<span class="co"># using summary function - imbalanced classes data</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">sb</span>)
<span class="co">#&gt; ** Split train/test set information **</span>
<span class="co">#&gt;  + random seed        :  50785 </span>
<span class="co">#&gt;  + split data            </span>
<span class="co">#&gt;     - train set count :  489 </span>
<span class="co">#&gt;     - test set count  :  210 </span>
<span class="co">#&gt;  + target variable    :  Class </span>
<span class="co">#&gt;     - minority class  :  malignant (0.344778)</span>
<span class="co">#&gt;     - majority class  :  benign (0.655222)</span></pre></div>
</div>
<div id="handling-the-imbalanced-classes-data" class="section level4">
<h4 class="hasAnchor">
<a href="#handling-the-imbalanced-classes-data" class="anchor"></a>Handling the imbalanced classes data</h4>
<p>Most machine learning algorithms work best when the number of samples in each class are about equal. And most algorithms are designed to maximize accuracy and reduce error. So, we requre handling an imbalanced class problem.</p>
<p>sampling_target() performs sampling to solve an imbalanced classes data problem.</p>
</div>
<div id="resampling---oversample-minority-class" class="section level4">
<h4 class="hasAnchor">
<a href="#resampling---oversample-minority-class" class="anchor"></a>Resampling - oversample minority class</h4>
<p>Oversampling can be defined as adding more copies of the minority class.</p>
<p>Oversampling is performed by specifying “ubOver” in the method argument of the <code><a href="reference/sampling_target.html">sampling_target()</a></code> function.</p>
<div class="sourceCode" id="cb29"><pre class="r"><span class="co"># to balanced by over sampling</span>
<span class="no">train_over</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ubOver"</span>)

<span class="co"># frequency table </span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">train_over</span>$<span class="no">Class</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;    benign malignant </span>
<span class="co">#&gt;       330       330</span></pre></div>
</div>
<div id="resampling---undersample-majority-class" class="section level4">
<h4 class="hasAnchor">
<a href="#resampling---undersample-majority-class" class="anchor"></a>Resampling - undersample majority class</h4>
<p>Undersampling can be defined as removing some observations of the majority class.</p>
<p>Undersampling is performed by specifying “ubUnder” in the method argument of the <code><a href="reference/sampling_target.html">sampling_target()</a></code> function.</p>
<div class="sourceCode" id="cb30"><pre class="r"><span class="co"># to balanced by under sampling</span>
<span class="no">train_under</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"ubUnder"</span>)

<span class="co"># frequency table </span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">train_under</span>$<span class="no">Class</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;    benign malignant </span>
<span class="co">#&gt;       159       159</span></pre></div>
</div>
<div id="generate-synthetic-samples---smote" class="section level4">
<h4 class="hasAnchor">
<a href="#generate-synthetic-samples---smote" class="anchor"></a>Generate synthetic samples - SMOTE</h4>
<p>SMOTE(Synthetic Minority Oversampling Technique) uses a nearest neighbors algorithm to generate new and synthetic data.</p>
<p>SMOTE is performed by specifying “ubSMOTE” in the method argument of the <code><a href="reference/sampling_target.html">sampling_target()</a></code> function.</p>
<div class="sourceCode" id="cb31"><pre class="r"><span class="co"># to balanced by SMOTE</span>
<span class="no">train_smote</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/sampling_target.html">sampling_target</a></span>(<span class="kw">seed</span> <span class="kw">=</span> <span class="fl">1234L</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"ubSMOTE"</span>)

<span class="co"># frequency table </span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">train_smote</span>$<span class="no">Class</span>)
<span class="co">#&gt; </span>
<span class="co">#&gt;    benign malignant </span>
<span class="co">#&gt;       636       477</span></pre></div>
</div>
</div>
<div id="cleansing-the-dataset-for-classification-modeling-with-cleanse" class="section level3">
<h3 class="hasAnchor">
<a href="#cleansing-the-dataset-for-classification-modeling-with-cleanse" class="anchor"></a>Cleansing the dataset for classification modeling with <code>cleanse()</code>
</h3>
<p>The <code><a href="reference/cleanse.data.frame.html">cleanse()</a></code> cleanse the dataset for classification modeling.</p>
<p>This function is useful when fit the classification model. This function does the following.:</p>
<ul>
<li>Remove the variable with only one value.</li>
<li>And remove variables that have a unique number of values relative to the number of observations for a character or categorical variable.
<ul>
<li>In this case, it is a variable that corresponds to an identifier or an identifier.</li>
</ul>
</li>
<li>And converts the character to factor.</li>
</ul>
<p>In this example, The <code><a href="reference/cleanse.data.frame.html">cleanse()</a></code> function removed a variable ID with a high unique rate.</p>
<div class="sourceCode" id="cb32"><pre class="r"><span class="co"># clean the training set</span>
<span class="no">train</span> <span class="kw">&lt;-</span> <span class="no">train_smote</span> <span class="kw">%&gt;%</span>
  <span class="no">cleanse</span>
<span class="co">#&gt; ── Checking unique value ─────────────────────────── unique value is one ──</span>
<span class="co">#&gt; No variables that unique value is one.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking unique rate ─────────────────────────────── high unique rate ──</span>
<span class="co">#&gt; remove variables with high unique rate</span>
<span class="co">#&gt; ● Id = 416(0.373764600179695)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking character variables ─────────────────────── categorical data ──</span>
<span class="co">#&gt; No character variables.</span></pre></div>
</div>
<div id="extract-test-set-for-evaluation-of-the-model-with-extract_set" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-test-set-for-evaluation-of-the-model-with-extract_set" class="anchor"></a>Extract test set for evaluation of the model with <code>extract_set()</code>
</h3>
<div class="sourceCode" id="cb33"><pre class="r"><span class="co"># extract test set</span>
<span class="no">test</span> <span class="kw">&lt;-</span> <span class="no">sb</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/extract_set.html">extract_set</a></span>(<span class="kw">set</span> <span class="kw">=</span> <span class="st">"test"</span>)</pre></div>
</div>
<div id="binary-classification-modeling-with-run_models" class="section level3">
<h3 class="hasAnchor">
<a href="#binary-classification-modeling-with-run_models" class="anchor"></a>Binary classification modeling with <code>run_models()</code>
</h3>
<p><code><a href="reference/run_models.html">run_models()</a></code> performs some representative binary classification modeling using <code>split_df</code> object created by <code><a href="reference/split_by.data.frame.html">split_by()</a></code>.</p>
<p><code><a href="reference/run_models.html">run_models()</a></code> executes the process in parallel when fitting the model. However, it is not supported in MS-Windows operating system and RStudio environment.</p>
<p>Currently supported algorithms are as follows.:</p>
<ul>
<li>logistic : logistic regression using <code>stats</code> package</li>
<li>rpart : Recursive Partitioning Trees using <code>rpart</code> package</li>
<li>ctree : Conditional Inference Trees using <code>party</code> package</li>
<li>randomForest :Classification with Random Forest using <code>randomForest</code> package</li>
<li>ranger : A Fast Implementation of Random Forests using <code>ranger</code> package</li>
</ul>
<p><code><a href="reference/run_models.html">run_models()</a></code> returns a <code>model_df</code> class object.</p>
<p>The <code>model_df</code> class object contains the following variables.:</p>
<ul>
<li>step : character. The current stage in the classification modeling process.
<ul>
<li>For objects created with <code><a href="reference/run_models.html">run_models()</a></code>, the value of the variable is “1.Fitted”.</li>
</ul>
</li>
<li>model_id : model identifiers</li>
<li>target : name of target variable</li>
<li>positive : positive class in target variable</li>
<li>fitted_model : list. Fitted model object by model_id’s algorithms</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb34"><pre class="r"><span class="no">result</span> <span class="kw">&lt;-</span> <span class="no">train</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/run_models.html">run_models</a></span>(<span class="kw">target</span> <span class="kw">=</span> <span class="st">"Class"</span>, <span class="kw">positive</span> <span class="kw">=</span> <span class="st">"malignant"</span>)
<span class="no">result</span>
<span class="co">#&gt; # A tibble: 5 x 5</span>
<span class="co">#&gt;   step     model_id     target positive  fitted_model</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;     &lt;list&gt;      </span>
<span class="co">#&gt; 1 1.Fitted logistic     Class  malignant &lt;glm&gt;       </span>
<span class="co">#&gt; 2 1.Fitted rpart        Class  malignant &lt;rpart&gt;     </span>
<span class="co">#&gt; 3 1.Fitted ctree        Class  malignant &lt;BinaryTr&gt;  </span>
<span class="co">#&gt; 4 1.Fitted randomForest Class  malignant &lt;rndmFrs.&gt;  </span>
<span class="co">#&gt; 5 1.Fitted ranger       Class  malignant &lt;ranger&gt;</span></pre></div>
</div>
<div id="evaluate-the-model" class="section level3">
<h3 class="hasAnchor">
<a href="#evaluate-the-model" class="anchor"></a>Evaluate the model</h3>
<p>Evaluate the predictive performance of fitted models.</p>
<div id="predict-test-set-using-fitted-model-with-run_predict" class="section level4">
<h4 class="hasAnchor">
<a href="#predict-test-set-using-fitted-model-with-run_predict" class="anchor"></a>Predict test set using fitted model with <code>run_predict()</code>
</h4>
<p><code><a href="reference/run_predict.html">run_predict()</a></code> predict the test set using <code>model_df</code> class fitted by <code><a href="reference/run_models.html">run_models()</a></code>.</p>
<p><code><a href="reference/run_predict.html">run_predict ()</a></code> is executed in parallel when predicting by model. However, it is not supported in MS-Windows operating system and RStudio environment.</p>
<p>The <code>model_df</code> class object contains the following variables.:</p>
<ul>
<li>step : character. The current stage in the classification modeling process.
<ul>
<li>For objects created with <code><a href="reference/run_predict.html">run_predict()</a></code>, the value of the variable is “2.Predicted”.</li>
</ul>
</li>
<li>model_id : character. Type of fit model.</li>
<li>target : character. Name of target variable.</li>
<li>positive : character. Level of positive class of binary classification.</li>
<li>fitted_model : list. Fitted model object by model_id’s algorithms.</li>
<li>predicted : result of predcit by each models</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb35"><pre class="r"><span class="no">pred</span> <span class="kw">&lt;-</span> <span class="no">result</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/run_predict.html">run_predict</a></span>(<span class="no">test</span>)
<span class="no">pred</span>
<span class="co">#&gt; # A tibble: 5 x 6</span>
<span class="co">#&gt;   step        model_id     target positive  fitted_model predicted  </span>
<span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;     &lt;list&gt;       &lt;list&gt;     </span>
<span class="co">#&gt; 1 2.Predicted logistic     Class  malignant &lt;glm&gt;        &lt;fct [210]&gt;</span>
<span class="co">#&gt; 2 2.Predicted rpart        Class  malignant &lt;rpart&gt;      &lt;fct [210]&gt;</span>
<span class="co">#&gt; 3 2.Predicted ctree        Class  malignant &lt;BinaryTr&gt;   &lt;fct [210]&gt;</span>
<span class="co">#&gt; 4 2.Predicted randomForest Class  malignant &lt;rndmFrs.&gt;   &lt;fct [210]&gt;</span>
<span class="co">#&gt; 5 2.Predicted ranger       Class  malignant &lt;ranger&gt;     &lt;fct [210]&gt;</span></pre></div>
</div>
<div id="calculate-the-performance-metric-with-run_performance" class="section level4">
<h4 class="hasAnchor">
<a href="#calculate-the-performance-metric-with-run_performance" class="anchor"></a>Calculate the performance metric with <code>run_performance()</code>
</h4>
<p><code><a href="reference/run_performance.html">run_performance()</a></code> calculate the performance metric of <code>model_df</code> class predicted by <code><a href="reference/run_predict.html">run_predict()</a></code>.</p>
<p><code><a href="reference/run_performance.html">run_performance ()</a></code> is performed in parallel when calculating the performance evaluation index. However, it is not supported in MS-Windows operating system and RStudio environment.</p>
<p>The <code>model_df</code> class object contains the following variables.:</p>
<ul>
<li>step : character. The current stage in the classification modeling process.
<ul>
<li>For objects created with <code><a href="reference/run_performance.html">run_performance()</a></code>, the value of the variable is “3.Performanced”.</li>
</ul>
</li>
<li>model_id : character. Type of fit model.</li>
<li>target : character. Name of target variable.</li>
<li>positive : character. Level of positive class of binary classification.</li>
<li>fitted_model : list. Fitted model object by model_id’s algorithms</li>
<li>predicted : list. Predicted value by individual model. Each value has a predict_class class object.</li>
<li>performance : list. Calculate metrics by individual model. Each value has a numeric vector.</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb36"><pre class="r"><span class="co"># Calculate performace metrics.</span>
<span class="no">perf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/run_performance.html">run_performance</a></span>(<span class="no">pred</span>)
<span class="no">perf</span>
<span class="co">#&gt; # A tibble: 5 x 7</span>
<span class="co">#&gt;   step          model_id     target positive fitted_model predicted  performance</span>
<span class="co">#&gt;   &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;  &lt;chr&gt;    &lt;list&gt;       &lt;list&gt;     &lt;list&gt;     </span>
<span class="co">#&gt; 1 3.Performanc… logistic     Class  maligna… &lt;glm&gt;        &lt;fct [210… &lt;dbl [15]&gt; </span>
<span class="co">#&gt; 2 3.Performanc… rpart        Class  maligna… &lt;rpart&gt;      &lt;fct [210… &lt;dbl [15]&gt; </span>
<span class="co">#&gt; 3 3.Performanc… ctree        Class  maligna… &lt;BinaryTr&gt;   &lt;fct [210… &lt;dbl [15]&gt; </span>
<span class="co">#&gt; 4 3.Performanc… randomForest Class  maligna… &lt;rndmFrs.&gt;   &lt;fct [210… &lt;dbl [15]&gt; </span>
<span class="co">#&gt; 5 3.Performanc… ranger       Class  maligna… &lt;ranger&gt;     &lt;fct [210… &lt;dbl [15]&gt;</span></pre></div>
<p>The performance variable contains a list object, which contains 15 performance metrics:</p>
<ul>
<li>ZeroOneLoss : Normalized Zero-One Loss(Classification Error Loss).</li>
<li>Accuracy : Accuracy.</li>
<li>Precision : Precision.</li>
<li>Recall : Recall.</li>
<li>Sensitivity : Sensitivity.</li>
<li>Specificity : Specificity.</li>
<li>F1_Score : F1 Score.</li>
<li>Fbeta_Score : F-Beta Score.</li>
<li>LogLoss : Log loss / Cross-Entropy Loss.</li>
<li>AUC : Area Under the Receiver Operating Characteristic Curve (ROC AUC).</li>
<li>Gini : Gini Coefficient.</li>
<li>PRAUC : Area Under the Precision-Recall Curve (PR AUC).</li>
<li>LiftAUC : Area Under the Lift Chart.</li>
<li>GainAUC : Area Under the Gain Chart.</li>
<li>KS_Stat : Kolmogorov-Smirnov Statistic.</li>
</ul>
<!-- end list --><div class="sourceCode" id="cb37"><pre class="r"><span class="co"># Performance by analytics models</span>
<span class="no">performance</span> <span class="kw">&lt;-</span> <span class="no">perf</span>$<span class="no">performance</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">performance</span>) <span class="kw">&lt;-</span> <span class="no">perf</span>$<span class="no">model_id</span>
<span class="no">performance</span>
<span class="co">#&gt; $logistic</span>
<span class="co">#&gt; ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity </span>
<span class="co">#&gt;  0.04761905  0.95238095  0.95000000  0.92682927  0.92682927  0.96875000 </span>
<span class="co">#&gt;    F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC </span>
<span class="co">#&gt;  0.93827160  0.93827160  1.51027400  0.95126715  0.94702744  0.06077086 </span>
<span class="co">#&gt;     LiftAUC     GainAUC     KS_Stat </span>
<span class="co">#&gt;  1.08596033  0.77505807 90.33917683 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rpart</span>
<span class="co">#&gt; ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity </span>
<span class="co">#&gt;  0.06190476  0.93809524  0.93670886  0.90243902  0.90243902  0.96093750 </span>
<span class="co">#&gt;    F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC </span>
<span class="co">#&gt;  0.91925466  0.91925466  0.41591455  0.92721037  0.89176829  0.80545712 </span>
<span class="co">#&gt;     LiftAUC     GainAUC     KS_Stat </span>
<span class="co">#&gt;  1.82146153  0.76039489 86.33765244 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ctree</span>
<span class="co">#&gt; ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity </span>
<span class="co">#&gt;  0.04761905  0.95238095  0.92857143  0.95121951  0.95121951  0.95312500 </span>
<span class="co">#&gt;    F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC </span>
<span class="co">#&gt;  0.93975904  0.93975904  0.61176450  0.97170351  0.95865091  0.47903471 </span>
<span class="co">#&gt;     LiftAUC     GainAUC     KS_Stat </span>
<span class="co">#&gt;  1.49393413  0.78751452 90.43445122 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $randomForest</span>
<span class="co">#&gt; ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity </span>
<span class="co">#&gt;  0.02857143  0.97142857  0.95238095  0.97560976  0.97560976  0.96875000 </span>
<span class="co">#&gt;    F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC </span>
<span class="co">#&gt;  0.96385542  0.96385542  0.09943100  0.99328316  0.98647104  0.68540128 </span>
<span class="co">#&gt;     LiftAUC     GainAUC     KS_Stat </span>
<span class="co">#&gt;  1.65902776  0.80066783 95.99847561 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ranger</span>
<span class="co">#&gt; ZeroOneLoss    Accuracy   Precision      Recall Sensitivity Specificity </span>
<span class="co">#&gt;  0.02380952  0.97619048  0.97530864  0.96341463  0.96341463  0.98437500 </span>
<span class="co">#&gt;    F1_Score Fbeta_Score     LogLoss         AUC        Gini       PRAUC </span>
<span class="co">#&gt;  0.96932515  0.96932515  0.09782736  0.99323552  0.98647104  0.76957551 </span>
<span class="co">#&gt;     LiftAUC     GainAUC     KS_Stat </span>
<span class="co">#&gt;  1.74052776  0.80063879 96.43673780</span></pre></div>
<p>If you change the list object to tidy format, you’ll see the following at a glance:</p>
<div class="sourceCode" id="cb38"><pre class="r"><span class="co"># Convert to matrix for compare performace.</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">performance</span>, <span class="st">"c"</span>)
<span class="co">#&gt;                logistic       rpart       ctree randomForest      ranger</span>
<span class="co">#&gt; ZeroOneLoss  0.04761905  0.06190476  0.04761905   0.02857143  0.02380952</span>
<span class="co">#&gt; Accuracy     0.95238095  0.93809524  0.95238095   0.97142857  0.97619048</span>
<span class="co">#&gt; Precision    0.95000000  0.93670886  0.92857143   0.95238095  0.97530864</span>
<span class="co">#&gt; Recall       0.92682927  0.90243902  0.95121951   0.97560976  0.96341463</span>
<span class="co">#&gt; Sensitivity  0.92682927  0.90243902  0.95121951   0.97560976  0.96341463</span>
<span class="co">#&gt; Specificity  0.96875000  0.96093750  0.95312500   0.96875000  0.98437500</span>
<span class="co">#&gt; F1_Score     0.93827160  0.91925466  0.93975904   0.96385542  0.96932515</span>
<span class="co">#&gt; Fbeta_Score  0.93827160  0.91925466  0.93975904   0.96385542  0.96932515</span>
<span class="co">#&gt; LogLoss      1.51027400  0.41591455  0.61176450   0.09943100  0.09782736</span>
<span class="co">#&gt; AUC          0.95126715  0.92721037  0.97170351   0.99328316  0.99323552</span>
<span class="co">#&gt; Gini         0.94702744  0.89176829  0.95865091   0.98647104  0.98647104</span>
<span class="co">#&gt; PRAUC        0.06077086  0.80545712  0.47903471   0.68540128  0.76957551</span>
<span class="co">#&gt; LiftAUC      1.08596033  1.82146153  1.49393413   1.65902776  1.74052776</span>
<span class="co">#&gt; GainAUC      0.77505807  0.76039489  0.78751452   0.80066783  0.80063879</span>
<span class="co">#&gt; KS_Stat     90.33917683 86.33765244 90.43445122  95.99847561 96.43673780</span></pre></div>
<p><code><a href="reference/compare_performance.html">compare_performance()</a></code> return a list object(results of compared model performance). and list has the following components:</p>
<ul>
<li>recommend_model : character. The name of the model that is recommended as the best among the various models.</li>
<li>top_count : numeric. The number of best performing performance metrics by model.</li>
<li>mean_rank : numeric. Average of ranking individual performance metrics by model.</li>
<li>top_metric : list. The name of the performance metric with the best performance on individual performance metrics by model.</li>
</ul>
<p>In this example, <code><a href="reference/compare_performance.html">compare_performance()</a></code> recommend the <strong>“ranger”</strong> model.</p>
<div class="sourceCode" id="cb39"><pre class="r"><span class="co"># Compaire the Performance metrics of each model</span>
<span class="no">comp_perf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/compare_performance.html">compare_performance</a></span>(<span class="no">pred</span>)
<span class="no">comp_perf</span>
<span class="co">#&gt; $recommend_model</span>
<span class="co">#&gt; [1] "ranger"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $top_metric_count</span>
<span class="co">#&gt;     logistic        rpart        ctree randomForest       ranger </span>
<span class="co">#&gt;            0            2            0            4            8 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_rank</span>
<span class="co">#&gt;     logistic        rpart        ctree randomForest       ranger </span>
<span class="co">#&gt;     3.961538     4.076923     3.615385     1.923077     1.423077 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $top_metric</span>
<span class="co">#&gt; $top_metric$logistic</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $top_metric$rpart</span>
<span class="co">#&gt; [1] "PRAUC"   "LiftAUC"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $top_metric$ctree</span>
<span class="co">#&gt; NULL</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $top_metric$randomForest</span>
<span class="co">#&gt; [1] "Recall"  "AUC"     "Gini"    "GainAUC"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $top_metric$ranger</span>
<span class="co">#&gt; [1] "ZeroOneLoss" "Accuracy"    "Precision"   "Specificity" "F1_Score"   </span>
<span class="co">#&gt; [6] "LogLoss"     "Gini"        "KS_Stat"</span></pre></div>
</div>
<div id="plot-the-roc-curve-with-plot_performance" class="section level4">
<h4 class="hasAnchor">
<a href="#plot-the-roc-curve-with-plot_performance" class="anchor"></a>Plot the ROC curve with <code>plot_performance()</code>
</h4>
<p><code><a href="reference/compare_performance.html">compare_performance()</a></code> plot ROC curve.</p>
<div class="sourceCode" id="cb40"><pre class="r"><span class="co"># Plot ROC curve</span>
<span class="fu"><a href="reference/plot_performance.html">plot_performance</a></span>(<span class="no">pred</span>)</pre></div>
<p><img src="reference/figures/README-ROC-1.png"><!-- --></p>
</div>
<div id="tunning-the-cut-off" class="section level4">
<h4 class="hasAnchor">
<a href="#tunning-the-cut-off" class="anchor"></a>Tunning the cut-off</h4>
<p>In general, if the prediction probability is greater than 0.5 in the binary classification model, it is predicted as <code>positive class</code>. In other words, 0.5 is used for the cut-off value. This applies to most model algorithms. However, in some cases, the performance can be tuned by changing the cut-off value.</p>
<p><code><a href="reference/plot_cutoff.html">plot_cutoff ()</a></code> visualizes a plot to select the cut-off value, and returns the cut-off value.</p>
<div class="sourceCode" id="cb41"><pre class="r"><span class="no">pred_best</span> <span class="kw">&lt;-</span> <span class="no">pred</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">model_id</span> <span class="kw">==</span> <span class="no">comp_perf</span>$<span class="no">recommend_model</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">predicted</span>) <span class="kw">%&gt;%</span>
  <span class="no">pull</span> <span class="kw">%&gt;%</span>
  <span class="no">.</span><span class="kw">[[</span><span class="fl">1</span>]] <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="st">"pred_prob"</span>)

<span class="no">cutoff</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/plot_cutoff.html">plot_cutoff</a></span>(<span class="no">pred_best</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"mcc"</span>)</pre></div>
<p><img src="reference/figures/README-cutoff-1.png"><!-- --></p>
<div class="sourceCode" id="cb42"><pre class="r"><span class="no">cutoff</span>
<span class="co">#&gt; [1] 0.4</span>

<span class="no">cutoff2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/plot_cutoff.html">plot_cutoff</a></span>(<span class="no">pred_best</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"density"</span>)</pre></div>
<p><img src="reference/figures/README-cutoff-2.png"><!-- --></p>
<div class="sourceCode" id="cb43"><pre class="r"><span class="no">cutoff2</span>
<span class="co">#&gt; [1] 0.9139</span>

<span class="no">cutoff3</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/plot_cutoff.html">plot_cutoff</a></span>(<span class="no">pred_best</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"prob"</span>)</pre></div>
<p><img src="reference/figures/README-cutoff-3.png"><!-- --></p>
<div class="sourceCode" id="cb44"><pre class="r"><span class="no">cutoff3</span>
<span class="co">#&gt; [1] 0.4</span></pre></div>
</div>
<div id="performance-comparison-between-prediction-and-tuned-cut-off-with-performance_metric" class="section level4">
<h4 class="hasAnchor">
<a href="#performance-comparison-between-prediction-and-tuned-cut-off-with-performance_metric" class="anchor"></a>Performance comparison between prediction and tuned cut-off with <code>performance_metric()</code>
</h4>
<p>Compare the performance of the original prediction with that of the tuned cut-off. Compare the cut-off with the non-cut model for the model with the best performance <code>comp_perf$recommend_model</code>.</p>
<div class="sourceCode" id="cb45"><pre class="r"><span class="no">comp_perf</span>$<span class="no">recommend_model</span>
<span class="co">#&gt; [1] "ranger"</span>

<span class="co"># extract predicted probability</span>
<span class="no">idx</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="no">pred</span>$<span class="no">model_id</span> <span class="kw">==</span> <span class="no">comp_perf</span>$<span class="no">recommend_model</span>)
<span class="no">pred_prob</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="no">pred</span>$<span class="no">predicted</span><span class="kw">[[</span><span class="no">idx</span>]], <span class="st">"pred_prob"</span>)

<span class="co"># or, extract predicted probability using dplyr</span>
<span class="no">pred_prob</span> <span class="kw">&lt;-</span> <span class="no">pred</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">model_id</span> <span class="kw">==</span> <span class="no">comp_perf</span>$<span class="no">recommend_model</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">predicted</span>) <span class="kw">%&gt;%</span>
  <span class="no">pull</span> <span class="kw">%&gt;%</span>
  <span class="st">"[["</span>(<span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span>(<span class="st">"pred_prob"</span>)

<span class="co"># predicted probability</span>
<span class="no">pred_prob</span>
<span class="co">#&gt;   [1] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0205833333</span>
<span class="co">#&gt;   [6] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000</span>
<span class="co">#&gt;  [11] 0.6707753968 0.0006944444 0.6684047619 0.9756777778 0.9949785714</span>
<span class="co">#&gt;  [16] 0.9990000000 0.6925880952 0.9037761905 0.5328198413 0.9166833333</span>
<span class="co">#&gt;  [21] 0.0331595238 0.0147444444 0.0000000000 0.0521071429 0.9940896825</span>
<span class="co">#&gt;  [26] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 1.0000000000</span>
<span class="co">#&gt;  [31] 0.7108809524 0.6118476190 0.8382333333 0.9996666667 0.9298571429</span>
<span class="co">#&gt;  [36] 1.0000000000 0.1262626984 0.0012190476 0.0027746032 0.8097222222</span>
<span class="co">#&gt;  [41] 0.1313126984 0.8987753968 0.0000000000 0.0000000000 0.1115285714</span>
<span class="co">#&gt;  [46] 0.9373230159 1.0000000000 0.0000000000 1.0000000000 0.0000000000</span>
<span class="co">#&gt;  [51] 0.0479595238 0.0000000000 0.0000000000 0.0000000000 1.0000000000</span>
<span class="co">#&gt;  [56] 0.9977166667 0.9947666667 0.0000000000 0.0000000000 0.0000000000</span>
<span class="co">#&gt;  [61] 0.9998000000 0.0000000000 0.9502523810 0.9975920635 1.0000000000</span>
<span class="co">#&gt;  [66] 0.9984444444 0.0000000000 0.0000000000 0.9685920635 0.0000000000</span>
<span class="co">#&gt;  [71] 1.0000000000 1.0000000000 0.9997500000 0.9995000000 0.0000000000</span>
<span class="co">#&gt;  [76] 0.9929277778 0.0160777778 0.0122246032 0.9988000000 1.0000000000</span>
<span class="co">#&gt;  [81] 0.9987000000 0.9988277778 0.9918174603 0.2190603175 0.0043333333</span>
<span class="co">#&gt;  [86] 0.0000000000 0.9037761905 0.0000000000 1.0000000000 0.9980952381</span>
<span class="co">#&gt;  [91] 0.0000000000 0.9927277778 0.0000000000 0.0008666667 0.0000000000</span>
<span class="co">#&gt;  [96] 0.0000000000 0.9517920635 0.0000000000 0.2981222222 0.8820182540</span>
<span class="co">#&gt; [101] 0.0000000000 0.9956428571 0.5261833333 0.9724634921 0.9946500000</span>
<span class="co">#&gt; [106] 0.0000000000 0.9869634921 0.0000000000 0.0000000000 0.0000000000</span>
<span class="co">#&gt; [111] 0.1347230159 0.0296865079 0.4730571429 0.0000000000 0.9128222222</span>
<span class="co">#&gt; [116] 0.5965928571 1.0000000000 0.9929666667 0.9420142857 1.0000000000</span>
<span class="co">#&gt; [121] 0.0000000000 0.0000000000 0.1508253968 0.0000000000 0.0000000000</span>
<span class="co">#&gt; [126] 0.9923833333 0.0000000000 0.0175500000 0.0030222222 0.0000000000</span>
<span class="co">#&gt; [131] 0.0000000000 0.9995000000 0.0198722222 0.0138111111 1.0000000000</span>
<span class="co">#&gt; [136] 0.0052142857 0.9744706349 0.9822666667 0.0095904762 0.0000000000</span>
<span class="co">#&gt; [141] 0.9216746032 0.1468793651 0.0000000000 0.4026603175 0.9991000000</span>
<span class="co">#&gt; [146] 0.9995000000 1.0000000000 0.0000000000 0.9941190476 1.0000000000</span>
<span class="co">#&gt; [151] 0.0000000000 0.9972500000 0.0000000000 0.0000000000 0.0000000000</span>
<span class="co">#&gt; [156] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000</span>
<span class="co">#&gt; [161] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000</span>
<span class="co">#&gt; [166] 0.0000000000 0.0000000000 0.0532007937 0.4910793651 0.0000000000</span>
<span class="co">#&gt; [171] 0.0057079365 1.0000000000 0.0000000000 0.0000000000 0.0218484127</span>
<span class="co">#&gt; [176] 1.0000000000 0.0000000000 0.9945523810 0.0117444444 0.0113055556</span>
<span class="co">#&gt; [181] 0.0000000000 0.0000000000 0.7085634921 0.9912404762 0.9178690476</span>
<span class="co">#&gt; [186] 0.0000000000 0.0000000000 0.0000000000 0.0000000000 0.0000000000</span>
<span class="co">#&gt; [191] 0.0000000000 0.0000000000 0.0000000000 0.9638690476 0.0000000000</span>
<span class="co">#&gt; [196] 0.0000000000 0.0000000000 0.0000000000 0.0032944444 0.9911285714</span>
<span class="co">#&gt; [201] 0.0000000000 0.0000000000 0.0000000000 1.0000000000 0.0000000000</span>
<span class="co">#&gt; [206] 0.0303150794 0.0000000000 0.0017968254 0.9897047619 0.9862357143</span>

<span class="co"># compaire Accuracy</span>
<span class="fu"><a href="reference/performance_metric.html">performance_metric</a></span>(<span class="no">pred_prob</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="st">"Accuracy"</span>)
<span class="co">#&gt; [1] 0.9761905</span>
<span class="fu"><a href="reference/performance_metric.html">performance_metric</a></span>(<span class="no">pred_prob</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="st">"Accuracy"</span>,
                   <span class="kw">cutoff</span> <span class="kw">=</span> <span class="no">cutoff</span>)
<span class="co">#&gt; [1] 0.9809524</span>

<span class="co"># compaire Confusion Matrix</span>
<span class="fu"><a href="reference/performance_metric.html">performance_metric</a></span>(<span class="no">pred_prob</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="st">"ConfusionMatrix"</span>)
<span class="co">#&gt;            actual</span>
<span class="co">#&gt; predict     benign malignant</span>
<span class="co">#&gt;   benign       126         3</span>
<span class="co">#&gt;   malignant      2        79</span>
<span class="fu"><a href="reference/performance_metric.html">performance_metric</a></span>(<span class="no">pred_prob</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="st">"ConfusionMatrix"</span>,
                   <span class="kw">cutoff</span> <span class="kw">=</span> <span class="no">cutoff</span>)
<span class="co">#&gt;            actual</span>
<span class="co">#&gt; predict     benign malignant</span>
<span class="co">#&gt;   benign       125         1</span>
<span class="co">#&gt;   malignant      3        81</span>

<span class="co"># compaire F1 Score</span>
<span class="fu"><a href="reference/performance_metric.html">performance_metric</a></span>(<span class="no">pred_prob</span>, <span class="no">test</span>$<span class="no">Class</span>, <span class="st">"malignant"</span>, <span class="st">"F1_Score"</span>)
<span class="co">#&gt; [1] 0.9693252</span>
<span class="fu"><a href="reference/performance_metric.html">performance_metric</a></span>(<span class="no">pred_prob</span>, <span class="no">test</span>$<span class="no">Class</span>,  <span class="st">"malignant"</span>, <span class="st">"F1_Score"</span>,
                   <span class="kw">cutoff</span> <span class="kw">=</span> <span class="no">cutoff</span>)
<span class="co">#&gt; [1] 0.9759036</span>
<span class="fu"><a href="reference/performance_metric.html">performance_metric</a></span>(<span class="no">pred_prob</span>, <span class="no">test</span>$<span class="no">Class</span>,  <span class="st">"malignant"</span>, <span class="st">"F1_Score"</span>,
                   <span class="kw">cutoff</span> <span class="kw">=</span> <span class="no">cutoff2</span>)
<span class="co">#&gt; [1] 0.8707483</span></pre></div>
<p>If the performance of the tuned cut-off is good, use it as a cut-off to predict positives.</p>
</div>
</div>
<div id="predict" class="section level3">
<h3 class="hasAnchor">
<a href="#predict" class="anchor"></a>Predict</h3>
<p>If you have selected a good model from several models, then perform the prediction with that model.</p>
<div id="create-data-set-for-predict" class="section level4">
<h4 class="hasAnchor">
<a href="#create-data-set-for-predict" class="anchor"></a>Create data set for predict</h4>
<p>Create sample data for predicting by extracting 100 samples from the data set used in the previous under sampling example.</p>
<div class="sourceCode" id="cb46"><pre class="r"><span class="no">data_pred</span> <span class="kw">&lt;-</span> <span class="no">train_under</span> <span class="kw">%&gt;%</span>
  <span class="no">cleanse</span>
<span class="co">#&gt; ── Checking unique value ─────────────────────────── unique value is one ──</span>
<span class="co">#&gt; No variables that unique value is one.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking unique rate ─────────────────────────────── high unique rate ──</span>
<span class="co">#&gt; remove variables with high unique rate</span>
<span class="co">#&gt; ● Id = 306(0.962264150943396)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Checking character variables ─────────────────────── categorical data ──</span>
<span class="co">#&gt; No character variables.</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1234L</span>)
<span class="no">data_pred</span> <span class="kw">&lt;-</span> <span class="no">data_pred</span> <span class="kw">%&gt;%</span>
  <span class="no">nrow</span> <span class="kw">%&gt;%</span>
  <span class="no">seq</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">50</span>) <span class="kw">%&gt;%</span>
  <span class="no">data_pred</span>[<span class="no">.</span>, ]</pre></div>
</div>
<div id="predict-with-alookr-and-dplyr" class="section level4">
<h4 class="hasAnchor">
<a href="#predict-with-alookr-and-dplyr" class="anchor"></a>Predict with alookr and dplyr</h4>
<p>Do a predict using the <code>dplyr</code> package. The last <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code> function eliminates unnecessary information.</p>
<div class="sourceCode" id="cb47"><pre class="r"><span class="no">pred_actual</span> <span class="kw">&lt;-</span> <span class="no">pred</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">model_id</span> <span class="kw">==</span> <span class="no">comp_perf</span>$<span class="no">recommend_model</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/run_predict.html">run_predict</a></span>(<span class="no">data_pred</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">predicted</span>) <span class="kw">%&gt;%</span>
  <span class="no">pull</span> <span class="kw">%&gt;%</span>
  <span class="st">"[["</span>(<span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>()

<span class="no">pred_actual</span>
<span class="co">#&gt;  [1] malignant malignant benign    benign    benign    malignant malignant</span>
<span class="co">#&gt;  [8] benign    malignant malignant benign    malignant malignant benign   </span>
<span class="co">#&gt; [15] malignant benign    malignant malignant malignant benign    malignant</span>
<span class="co">#&gt; [22] benign    benign    malignant malignant malignant malignant malignant</span>
<span class="co">#&gt; [29] malignant malignant benign    benign    malignant malignant benign   </span>
<span class="co">#&gt; [36] benign    benign    malignant malignant benign    benign    malignant</span>
<span class="co">#&gt; [43] benign    benign    benign    malignant benign    benign    malignant</span>
<span class="co">#&gt; [50] benign   </span>
<span class="co">#&gt; Levels: benign malignant</span></pre></div>
<p>If you want to predict by cut-off, specify the <code>cutoff</code> argument in the <code><a href="reference/run_predict.html">run_predict()</a></code> function as follows.:</p>
<p>In the example, there is no difference between the results of using cut-off and not.</p>
<div class="sourceCode" id="cb48"><pre class="r"><span class="no">pred_actual2</span> <span class="kw">&lt;-</span> <span class="no">pred</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">model_id</span> <span class="kw">==</span> <span class="no">comp_perf</span>$<span class="no">recommend_model</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/run_predict.html">run_predict</a></span>(<span class="no">data_pred</span>, <span class="no">cutoff</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">predicted</span>) <span class="kw">%&gt;%</span>
  <span class="no">pull</span> <span class="kw">%&gt;%</span>
  <span class="st">"[["</span>(<span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>()

<span class="no">pred_actual2</span>
<span class="co">#&gt;  [1] malignant malignant benign    benign    benign    malignant malignant</span>
<span class="co">#&gt;  [8] benign    malignant malignant benign    malignant malignant benign   </span>
<span class="co">#&gt; [15] malignant benign    malignant malignant malignant benign    malignant</span>
<span class="co">#&gt; [22] benign    benign    malignant malignant malignant malignant malignant</span>
<span class="co">#&gt; [29] malignant malignant benign    benign    malignant malignant benign   </span>
<span class="co">#&gt; [36] benign    benign    malignant malignant benign    benign    malignant</span>
<span class="co">#&gt; [43] benign    benign    benign    malignant benign    benign    malignant</span>
<span class="co">#&gt; [50] benign   </span>
<span class="co">#&gt; Levels: benign malignant</span>

<span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">pred_actual</span> <span class="kw">!=</span> <span class="no">pred_actual2</span>)
<span class="co">#&gt; [1] 0</span></pre></div>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=alookr">https://​cloud.r-project.org/​package=alookr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/choonghyunryu/alookr/">https://​github.com/​choonghyunryu/​alookr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/choonghyunryu/alookr/issues">https://​github.com/​choonghyunryu/​alookr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Choonghyun Ryu <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=alookr"><img src="http://www.r-pkg.org/badges/version/alookr" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://cran.r-project.org/package=alookr"><img src="https://cranlogs.r-pkg.org/badges/grand-total/alookr" alt="Total Downloads"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Choonghyun Ryu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
